2025-06-05 13:13:29,042 - s3_parquet_to_postgres_ingestion - INFO - Listing latest Parquet files from s3://rj-ecommerce-data-lake/raw/...
2025-06-05 13:13:33,181 - s3_parquet_to_postgres_ingestion - INFO - Skipping processing for 'product_category_name_translation' as requested.
2025-06-05 13:13:34,238 - s3_parquet_to_postgres_ingestion - INFO - Found 8 datasets to process.
2025-06-05 13:13:34,239 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet -> Database table: geolocation
2025-06-05 13:13:41,566 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet with 1000163 rows.
2025-06-05 13:13:42,301 - s3_parquet_to_postgres_ingestion - WARNING - Removed 280009 duplicate rows based on composite key from 'geolocation'.
2025-06-05 13:13:42,301 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 720154 rows into table 'geolocation'...
2025-06-05 13:13:42,386 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'geolocation'...
2025-06-05 13:13:43,698 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'geolocation'...
2025-06-05 13:13:48,111 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 720154 rows into 'geolocation'.
2025-06-05 13:13:48,116 - s3_parquet_to_postgres_ingestion - INFO - Fetching geolocation_id mapping from the database...
2025-06-05 13:13:48,323 - s3_parquet_to_postgres_ingestion - INFO - Fetched 19015 unique zip code to geolocation_id mappings.
2025-06-05 13:13:48,323 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet -> Database table: customers
2025-06-05 13:13:52,388 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet with 99441 rows.
2025-06-05 13:13:52,467 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'customers'...
2025-06-05 13:13:52,467 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'customers'...
2025-06-05 13:13:52,647 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'customers'...
2025-06-05 13:13:53,455 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'customers'.
2025-06-05 13:13:53,456 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet -> Database table: sellers
2025-06-05 13:13:53,766 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet with 3095 rows.
2025-06-05 13:13:53,781 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 3095 rows into table 'sellers'...
2025-06-05 13:13:53,781 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'sellers'...
2025-06-05 13:13:53,797 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'sellers'...
2025-06-05 13:13:53,837 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 3095 rows into 'sellers'.
2025-06-05 13:13:53,838 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet -> Database table: products
2025-06-05 13:13:54,728 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet with 32951 rows.
2025-06-05 13:13:54,728 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 32951 rows into table 'products'...
2025-06-05 13:13:54,728 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'products'...
2025-06-05 13:13:54,845 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'products'...
2025-06-05 13:13:55,042 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 32951 rows into 'products'.
2025-06-05 13:13:55,042 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet -> Database table: orders
2025-06-05 13:13:59,349 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet with 99441 rows.
2025-06-05 13:13:59,350 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'orders'...
2025-06-05 13:13:59,350 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'orders'...
2025-06-05 13:13:59,603 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'orders'...
2025-06-05 13:14:00,692 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'orders'.
2025-06-05 13:14:00,696 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet -> Database table: order_items
2025-06-05 13:14:03,893 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet with 112650 rows.
2025-06-05 13:14:03,901 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 112650 rows into table 'order_items'...
2025-06-05 13:14:03,901 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_items'...
2025-06-05 13:14:04,205 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_items'...
2025-06-05 13:14:05,869 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 112650 rows into 'order_items'.
2025-06-05 13:14:05,873 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet -> Database table: order_payments
2025-06-05 13:14:08,082 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet with 103886 rows.
2025-06-05 13:14:08,089 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 103886 rows into table 'order_payments'...
2025-06-05 13:14:08,090 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_payments'...
2025-06-05 13:14:08,228 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_payments'...
2025-06-05 13:14:09,154 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 103886 rows into 'order_payments'.
2025-06-05 13:14:09,155 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet -> Database table: order_reviews
2025-06-05 13:14:13,978 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet with 99224 rows.
2025-06-05 13:14:13,992 - s3_parquet_to_postgres_ingestion - WARNING - Removed 814 duplicate review_id rows from 'order_reviews'.
2025-06-05 13:14:13,992 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 98410 rows into table 'order_reviews'...
2025-06-05 13:14:13,993 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_reviews'...
2025-06-05 13:14:14,207 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_reviews'...
2025-06-05 13:14:15,275 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 98410 rows into 'order_reviews'.
2025-06-05 13:14:15,278 - s3_parquet_to_postgres_ingestion - INFO - S3 Parquet to PostgreSQL data ingestion process completed.
