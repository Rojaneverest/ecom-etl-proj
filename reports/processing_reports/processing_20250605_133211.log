2025-06-05 13:32:11,586 - s3_parquet_to_postgres_ingestion - INFO - Listing latest Parquet files from s3://rj-ecommerce-data-lake/raw/...
2025-06-05 13:32:17,509 - s3_parquet_to_postgres_ingestion - INFO - Skipping processing for 'product_category_name_translation' as requested.
2025-06-05 13:32:17,509 - s3_parquet_to_postgres_ingestion - INFO - Found 8 datasets to process.
2025-06-05 13:32:17,509 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet -> Database table: geolocation
2025-06-05 13:32:34,161 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet with 1000163 rows.
2025-06-05 13:32:34,763 - s3_parquet_to_postgres_ingestion - WARNING - Removed 280009 duplicate rows based on composite key from 'geolocation'.
2025-06-05 13:33:33,704 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet
2025-06-05 13:33:33,708 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 720154 rows into table 'geolocation'...
2025-06-05 13:33:33,866 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'geolocation'...
2025-06-05 13:33:35,155 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'geolocation'...
2025-06-05 13:33:39,409 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 720154 rows into 'geolocation'.
2025-06-05 13:33:39,418 - s3_parquet_to_postgres_ingestion - INFO - Fetching geolocation_id mapping from the database...
2025-06-05 13:33:39,618 - s3_parquet_to_postgres_ingestion - INFO - Fetched 19015 unique zip code to geolocation_id mappings.
2025-06-05 13:33:41,060 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_geolocation_dataset/2025-06-05/report.json
2025-06-05 13:33:41,061 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet -> Database table: customers
2025-06-05 13:33:44,721 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet with 99441 rows.
2025-06-05 13:34:15,654 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet
2025-06-05 13:34:15,656 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'customers'...
2025-06-05 13:34:15,657 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'customers'...
2025-06-05 13:34:15,879 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'customers'...
2025-06-05 13:34:16,762 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'customers'.
2025-06-05 13:34:17,313 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_customers_dataset/2025-06-05/report.json
2025-06-05 13:34:17,313 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet -> Database table: sellers
2025-06-05 13:34:17,632 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet with 3095 rows.
2025-06-05 13:34:19,155 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet
2025-06-05 13:34:19,155 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 3095 rows into table 'sellers'...
2025-06-05 13:34:19,156 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'sellers'...
2025-06-05 13:34:19,182 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'sellers'...
2025-06-05 13:34:19,234 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 3095 rows into 'sellers'.
2025-06-05 13:34:19,873 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_sellers_dataset/2025-06-05/report.json
2025-06-05 13:34:19,874 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet -> Database table: products
2025-06-05 13:34:20,830 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet with 32951 rows.
2025-06-05 13:34:26,968 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_products_dataset/2025-06-05/olist_products_dataset.parquet
2025-06-05 13:34:26,969 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 32951 rows into table 'products'...
2025-06-05 13:34:26,969 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'products'...
2025-06-05 13:34:27,101 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'products'...
2025-06-05 13:34:27,283 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 32951 rows into 'products'.
2025-06-05 13:34:27,860 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_products_dataset/2025-06-05/report.json
2025-06-05 13:34:27,860 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet -> Database table: orders
2025-06-05 13:34:33,469 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet with 99441 rows.
2025-06-05 13:35:10,617 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet
2025-06-05 13:35:10,619 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'orders'...
2025-06-05 13:35:10,621 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'orders'...
2025-06-05 13:35:10,908 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'orders'...
2025-06-05 13:35:11,968 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'orders'.
2025-06-05 13:35:12,607 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_orders_dataset/2025-06-05/report.json
2025-06-05 13:35:12,607 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet -> Database table: order_items
2025-06-05 13:35:16,409 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet with 112650 rows.
2025-06-05 13:35:31,730 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet
2025-06-05 13:35:31,731 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 112650 rows into table 'order_items'...
2025-06-05 13:35:31,731 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_items'...
2025-06-05 13:35:32,047 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_items'...
2025-06-05 13:35:33,951 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 112650 rows into 'order_items'.
2025-06-05 13:35:34,525 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_order_items_dataset/2025-06-05/report.json
2025-06-05 13:35:34,526 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet -> Database table: order_payments
2025-06-05 13:35:36,630 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet with 103886 rows.
2025-06-05 13:35:49,694 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet
2025-06-05 13:35:49,697 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 103886 rows into table 'order_payments'...
2025-06-05 13:35:49,697 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_payments'...
2025-06-05 13:35:49,865 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_payments'...
2025-06-05 13:35:50,892 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 103886 rows into 'order_payments'.
2025-06-05 13:35:51,520 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_order_payments_dataset/2025-06-05/report.json
2025-06-05 13:35:51,520 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet -> Database table: order_reviews
2025-06-05 13:35:56,881 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet with 99224 rows.
2025-06-05 13:35:56,891 - s3_parquet_to_postgres_ingestion - INFO - Replaced 0 null values with 'None' in review_comment_title column.
2025-06-05 13:35:56,898 - s3_parquet_to_postgres_ingestion - INFO - Replaced 0 null values with 'None' in review_comment_message column.
2025-06-05 13:35:56,912 - s3_parquet_to_postgres_ingestion - WARNING - Removed 814 duplicate review_id rows from 'order_reviews'.
2025-06-05 13:36:37,526 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet
2025-06-05 13:36:37,529 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 98410 rows into table 'order_reviews'...
2025-06-05 13:36:37,530 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_reviews'...
2025-06-05 13:36:37,789 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_reviews'...
2025-06-05 13:36:38,777 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 98410 rows into 'order_reviews'.
2025-06-05 13:36:39,369 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_order_reviews_dataset/2025-06-05/report.json
2025-06-05 13:36:39,983 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved overall processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/overall_processing/2025-06-05/overall_report.json
2025-06-05 13:36:39,984 - s3_parquet_to_postgres_ingestion - INFO - S3 Parquet to PostgreSQL data ingestion process completed.
2025-06-05 13:36:39,984 - s3_parquet_to_postgres_ingestion - INFO - Summary: 8/8 datasets processed successfully.
2025-06-05 13:36:39,984 - s3_parquet_to_postgres_ingestion - INFO - Total rows processed: 1270028
