2025-06-05 16:45:44,880 - s3_parquet_to_postgres_ingestion - INFO - Listing latest Parquet files from s3://rj-ecom-etl/raw/...
2025-06-05 16:45:48,576 - s3_parquet_to_postgres_ingestion - INFO - Skipping processing for 'product_category_name_translation' as requested.
2025-06-05 16:45:51,517 - s3_parquet_to_postgres_ingestion - INFO - Found 8 datasets to process.
2025-06-05 16:45:51,518 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet -> Database table: geolocation
2025-06-05 16:46:00,601 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet with 1000163 rows.
2025-06-05 16:46:03,397 - s3_parquet_to_postgres_ingestion - WARNING - Removed 280009 duplicate rows based on composite key from 'geolocation'.
2025-06-05 16:47:12,208 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet
2025-06-05 16:47:12,212 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 720154 rows into table 'geolocation'...
2025-06-05 16:47:12,291 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'geolocation'...
2025-06-05 16:47:13,622 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'geolocation'...
2025-06-05 16:47:18,100 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 720154 rows into 'geolocation'.
2025-06-05 16:47:18,105 - s3_parquet_to_postgres_ingestion - INFO - Fetching geolocation_id mapping from the database...
2025-06-05 16:47:18,951 - s3_parquet_to_postgres_ingestion - INFO - Fetched 19015 unique zip code to geolocation_id mappings.
2025-06-05 16:47:20,390 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_geolocation_dataset/2025-06-05/report.json
2025-06-05 16:47:20,391 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet -> Database table: customers
2025-06-05 16:47:25,629 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet with 99441 rows.
2025-06-05 16:47:29,825 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet
2025-06-05 16:47:29,827 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'customers'...
2025-06-05 16:47:29,827 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'customers'...
2025-06-05 16:47:30,064 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'customers'...
2025-06-05 16:47:31,095 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'customers'.
2025-06-05 16:47:31,786 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_customers_dataset/2025-06-05/report.json
2025-06-05 16:47:31,787 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet -> Database table: sellers
2025-06-05 16:47:32,209 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet with 3095 rows.
2025-06-05 16:47:32,924 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet
2025-06-05 16:47:32,924 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 3095 rows into table 'sellers'...
2025-06-05 16:47:32,925 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'sellers'...
2025-06-05 16:47:32,954 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'sellers'...
2025-06-05 16:47:33,008 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 3095 rows into 'sellers'.
2025-06-05 16:47:33,690 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_sellers_dataset/2025-06-05/report.json
2025-06-05 16:47:33,690 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet -> Database table: products
2025-06-05 16:47:34,533 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet with 32951 rows.
2025-06-05 16:47:35,412 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_products_dataset/2025-06-05/olist_products_dataset.parquet
2025-06-05 16:47:35,413 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 32951 rows into table 'products'...
2025-06-05 16:47:35,413 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'products'...
2025-06-05 16:47:35,539 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'products'...
2025-06-05 16:47:35,736 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 32951 rows into 'products'.
2025-06-05 16:47:36,412 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_products_dataset/2025-06-05/report.json
2025-06-05 16:47:36,413 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet -> Database table: orders
2025-06-05 16:47:40,603 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet with 99441 rows.
2025-06-05 16:47:42,933 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet
2025-06-05 16:47:42,934 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'orders'...
2025-06-05 16:47:42,934 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'orders'...
2025-06-05 16:47:43,224 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'orders'...
2025-06-05 16:47:44,388 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'orders'.
2025-06-05 16:47:45,085 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_orders_dataset/2025-06-05/report.json
2025-06-05 16:47:45,085 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet -> Database table: order_items
2025-06-05 16:47:48,138 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet with 112650 rows.
2025-06-05 16:47:49,954 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet
2025-06-05 16:47:49,955 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 112650 rows into table 'order_items'...
2025-06-05 16:47:49,956 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_items'...
2025-06-05 16:47:50,253 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_items'...
2025-06-05 16:47:51,993 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 112650 rows into 'order_items'.
2025-06-05 16:47:52,719 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_order_items_dataset/2025-06-05/report.json
2025-06-05 16:47:52,720 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet -> Database table: order_payments
2025-06-05 16:47:54,781 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet with 103886 rows.
2025-06-05 16:47:56,118 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet
2025-06-05 16:47:56,119 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 103886 rows into table 'order_payments'...
2025-06-05 16:47:56,120 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_payments'...
2025-06-05 16:47:56,282 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_payments'...
2025-06-05 16:47:57,178 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 103886 rows into 'order_payments'.
2025-06-05 16:47:58,043 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_order_payments_dataset/2025-06-05/report.json
2025-06-05 16:47:58,044 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet -> Database table: order_reviews
2025-06-05 16:48:01,768 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecom-etl/raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet with 99224 rows.
2025-06-05 16:48:01,856 - s3_parquet_to_postgres_ingestion - INFO - Replaced 87658 null/empty values with 'None' in review_comment_title column.
2025-06-05 16:48:01,948 - s3_parquet_to_postgres_ingestion - INFO - Replaced 58274 null/empty values with 'None' in review_comment_message column.
2025-06-05 16:48:01,959 - s3_parquet_to_postgres_ingestion - WARNING - Removed 814 duplicate review_id rows from 'order_reviews'.
2025-06-05 16:48:03,916 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecom-etl/processed/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet
2025-06-05 16:48:03,916 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 98410 rows into table 'order_reviews'...
2025-06-05 16:48:03,917 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_reviews'...
2025-06-05 16:48:04,166 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_reviews'...
2025-06-05 16:48:05,290 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 98410 rows into 'order_reviews'.
2025-06-05 16:48:05,970 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecom-etl/reports/processing_reports/olist_order_reviews_dataset/2025-06-05/report.json
2025-06-05 16:48:06,660 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved overall processing report to s3://rj-ecom-etl/reports/processing_reports/overall_processing/2025-06-05/overall_report.json
2025-06-05 16:48:06,661 - s3_parquet_to_postgres_ingestion - INFO - S3 Parquet to PostgreSQL data ingestion process completed.
2025-06-05 16:48:06,661 - s3_parquet_to_postgres_ingestion - INFO - Summary: 8/8 datasets processed successfully.
2025-06-05 16:48:06,661 - s3_parquet_to_postgres_ingestion - INFO - Total rows processed: 1270028
