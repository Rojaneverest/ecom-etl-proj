2025-06-05 13:44:10,279 - s3_parquet_to_postgres_ingestion - INFO - Listing latest Parquet files from s3://rj-ecommerce-data-lake/raw/...
2025-06-05 13:44:13,057 - s3_parquet_to_postgres_ingestion - INFO - Skipping processing for 'product_category_name_translation' as requested.
2025-06-05 13:44:14,915 - s3_parquet_to_postgres_ingestion - INFO - Found 8 datasets to process.
2025-06-05 13:44:14,916 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet -> Database table: geolocation
2025-06-05 13:44:22,107 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet with 1000163 rows.
2025-06-05 13:44:22,730 - s3_parquet_to_postgres_ingestion - WARNING - Removed 280009 duplicate rows based on composite key from 'geolocation'.
2025-06-05 13:45:00,244 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_geolocation_dataset/2025-06-05/olist_geolocation_dataset.parquet
2025-06-05 13:45:00,248 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 720154 rows into table 'geolocation'...
2025-06-05 13:45:00,317 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'geolocation'...
2025-06-05 13:45:01,664 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'geolocation'...
2025-06-05 13:45:05,765 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 720154 rows into 'geolocation'.
2025-06-05 13:45:05,770 - s3_parquet_to_postgres_ingestion - INFO - Fetching geolocation_id mapping from the database...
2025-06-05 13:45:05,974 - s3_parquet_to_postgres_ingestion - INFO - Fetched 19015 unique zip code to geolocation_id mappings.
2025-06-05 13:45:06,429 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_geolocation_dataset/2025-06-05/report.json
2025-06-05 13:45:06,429 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet -> Database table: customers
2025-06-05 13:45:11,103 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet with 99441 rows.
2025-06-05 13:45:37,561 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_customers_dataset/2025-06-05/olist_customers_dataset.parquet
2025-06-05 13:45:37,563 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'customers'...
2025-06-05 13:45:37,563 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'customers'...
2025-06-05 13:45:37,772 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'customers'...
2025-06-05 13:45:38,593 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'customers'.
2025-06-05 13:45:39,039 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_customers_dataset/2025-06-05/report.json
2025-06-05 13:45:39,040 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet -> Database table: sellers
2025-06-05 13:45:39,354 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet with 3095 rows.
2025-06-05 13:45:40,473 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_sellers_dataset/2025-06-05/olist_sellers_dataset.parquet
2025-06-05 13:45:40,473 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 3095 rows into table 'sellers'...
2025-06-05 13:45:40,474 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'sellers'...
2025-06-05 13:45:40,498 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'sellers'...
2025-06-05 13:45:40,548 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 3095 rows into 'sellers'.
2025-06-05 13:45:41,176 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_sellers_dataset/2025-06-05/report.json
2025-06-05 13:45:41,176 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet -> Database table: products
2025-06-05 13:45:42,327 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_products_dataset/2025-06-05/olist_products_dataset.parquet with 32951 rows.
2025-06-05 13:45:50,050 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_products_dataset/2025-06-05/olist_products_dataset.parquet
2025-06-05 13:45:50,050 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 32951 rows into table 'products'...
2025-06-05 13:45:50,050 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'products'...
2025-06-05 13:45:50,179 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'products'...
2025-06-05 13:45:50,373 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 32951 rows into 'products'.
2025-06-05 13:45:50,829 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_products_dataset/2025-06-05/report.json
2025-06-05 13:45:50,829 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet -> Database table: orders
2025-06-05 13:45:57,378 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet with 99441 rows.
2025-06-05 13:46:33,424 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_orders_dataset/2025-06-05/olist_orders_dataset.parquet
2025-06-05 13:46:33,426 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 99441 rows into table 'orders'...
2025-06-05 13:46:33,426 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'orders'...
2025-06-05 13:46:33,712 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'orders'...
2025-06-05 13:46:34,697 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 99441 rows into 'orders'.
2025-06-05 13:46:35,146 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_orders_dataset/2025-06-05/report.json
2025-06-05 13:46:35,147 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet -> Database table: order_items
2025-06-05 13:46:38,470 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet with 112650 rows.
2025-06-05 13:46:57,870 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_order_items_dataset/2025-06-05/olist_order_items_dataset.parquet
2025-06-05 13:46:57,874 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 112650 rows into table 'order_items'...
2025-06-05 13:46:57,875 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_items'...
2025-06-05 13:46:58,193 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_items'...
2025-06-05 13:47:00,349 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 112650 rows into 'order_items'.
2025-06-05 13:47:00,804 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_order_items_dataset/2025-06-05/report.json
2025-06-05 13:47:00,804 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet -> Database table: order_payments
2025-06-05 13:47:02,947 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet with 103886 rows.
2025-06-05 13:47:15,887 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_order_payments_dataset/2025-06-05/olist_order_payments_dataset.parquet
2025-06-05 13:47:15,889 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 103886 rows into table 'order_payments'...
2025-06-05 13:47:15,889 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_payments'...
2025-06-05 13:47:16,054 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_payments'...
2025-06-05 13:47:17,023 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 103886 rows into 'order_payments'.
2025-06-05 13:47:17,485 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_order_payments_dataset/2025-06-05/report.json
2025-06-05 13:47:17,486 - s3_parquet_to_postgres_ingestion - INFO - Processing S3 key: raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet -> Database table: order_reviews
2025-06-05 13:47:22,974 - s3_parquet_to_postgres_ingestion - INFO - Downloaded s3://rj-ecommerce-data-lake/raw/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet with 99224 rows.
2025-06-05 13:47:23,011 - s3_parquet_to_postgres_ingestion - INFO - Replaced 87658 null/empty values with 'None' in review_comment_title column.
2025-06-05 13:47:23,054 - s3_parquet_to_postgres_ingestion - INFO - Replaced 58274 null/empty values with 'None' in review_comment_message column.
2025-06-05 13:47:23,065 - s3_parquet_to_postgres_ingestion - WARNING - Removed 814 duplicate review_id rows from 'order_reviews'.
2025-06-05 13:47:56,130 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processed data to s3://rj-ecommerce-data-lake/processed/olist_order_reviews_dataset/2025-06-05/olist_order_reviews_dataset.parquet
2025-06-05 13:47:56,133 - s3_parquet_to_postgres_ingestion - INFO - Attempting to ingest 98410 rows into table 'order_reviews'...
2025-06-05 13:47:56,134 - s3_parquet_to_postgres_ingestion - INFO - Truncating table 'order_reviews'...
2025-06-05 13:47:56,404 - s3_parquet_to_postgres_ingestion - INFO - Executing COPY for table 'order_reviews'...
2025-06-05 13:47:57,400 - s3_parquet_to_postgres_ingestion - INFO - Successfully ingested 98410 rows into 'order_reviews'.
2025-06-05 13:47:57,852 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/olist_order_reviews_dataset/2025-06-05/report.json
2025-06-05 13:47:58,323 - s3_parquet_to_postgres_ingestion - INFO - Successfully saved overall processing report to s3://rj-ecommerce-data-lake/reports/processing_reports/overall_processing/2025-06-05/overall_report.json
2025-06-05 13:47:58,323 - s3_parquet_to_postgres_ingestion - INFO - S3 Parquet to PostgreSQL data ingestion process completed.
2025-06-05 13:47:58,323 - s3_parquet_to_postgres_ingestion - INFO - Summary: 8/8 datasets processed successfully.
2025-06-05 13:47:58,324 - s3_parquet_to_postgres_ingestion - INFO - Total rows processed: 1270028
