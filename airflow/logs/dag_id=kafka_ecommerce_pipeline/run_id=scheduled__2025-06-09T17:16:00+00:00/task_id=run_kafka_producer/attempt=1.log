[2025-06-09T17:17:27.450+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: kafka_ecommerce_pipeline.run_kafka_producer scheduled__2025-06-09T17:16:00+00:00 [queued]>
[2025-06-09T17:17:27.459+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: kafka_ecommerce_pipeline.run_kafka_producer scheduled__2025-06-09T17:16:00+00:00 [queued]>
[2025-06-09T17:17:27.460+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 3
[2025-06-09T17:17:27.470+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_kafka_producer> on 2025-06-09 17:16:00+00:00
[2025-06-09T17:17:27.473+0000] {standard_task_runner.py:60} INFO - Started process 5385 to run task
[2025-06-09T17:17:27.476+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'kafka_ecommerce_pipeline', 'run_kafka_producer', 'scheduled__2025-06-09T17:16:00+00:00', '--job-id', '595', '--raw', '--subdir', 'DAGS_FOLDER/kafka_data_pipeline.py', '--cfg-path', '/tmp/tmp23ja_nox']
[2025-06-09T17:17:27.477+0000] {standard_task_runner.py:88} INFO - Job 595: Subtask run_kafka_producer
[2025-06-09T17:17:27.539+0000] {task_command.py:423} INFO - Running <TaskInstance: kafka_ecommerce_pipeline.run_kafka_producer scheduled__2025-06-09T17:16:00+00:00 [running]> on host ed7c78a1ebb0
[2025-06-09T17:17:27.613+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='data-engineering-team' AIRFLOW_CTX_DAG_ID='kafka_ecommerce_pipeline' AIRFLOW_CTX_TASK_ID='run_kafka_producer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-09T17:16:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-09T17:16:00+00:00'
[2025-06-09T17:17:27.614+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T17:17:27.615+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /app/kafka_scripts/producer.py']
[2025-06-09T17:17:27.627+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T17:24:06.101+0000] {subprocess.py:93} INFO - üöÄ Starting E-Commerce Event Producer
[2025-06-09T17:24:06.185+0000] {subprocess.py:93} INFO - üîó Kafka Bootstrap Servers: kafka:29092
[2025-06-09T17:24:06.189+0000] {subprocess.py:93} INFO - üöÄ Initializing Kafka producer with bootstrap servers: kafka:29092
[2025-06-09T17:24:06.195+0000] {subprocess.py:93} INFO - ‚ö†Ô∏è Error creating topics: [Error 36] TopicAlreadyExistsError: Request 'CreateTopicsRequest_v3(create_topic_requests=[(topic='ecommerce.product.views', num_partitions=3, replication_factor=1, replica_assignment=[], configs=[]), (topic='ecommerce.cart.add', num_partitions=3, replication_factor=1, replica_assignment=[], configs=[]), (topic='ecommerce.wishlist.add', num_partitions=3, replication_factor=1, replica_assignment=[], configs=[]), (topic='ecommerce.orders.completed', num_partitions=3, replication_factor=1, replica_assignment=[], configs=[])], timeout=30000, validate_only=False)' failed with response 'CreateTopicsResponse_v3(throttle_time_ms=0, topic_errors=[(topic='ecommerce.product.views', error_code=36, error_message="Topic 'ecommerce.product.views' already exists."), (topic='ecommerce.cart.add', error_code=36, error_message="Topic 'ecommerce.cart.add' already exists."), (topic='ecommerce.wishlist.add', error_code=36, error_message="Topic 'ecommerce.wishlist.add' already exists."), (topic='ecommerce.orders.completed', error_code=36, error_message="Topic 'ecommerce.orders.completed' already exists.")])'.
[2025-06-09T17:24:06.199+0000] {subprocess.py:93} INFO - ‚úÖ Successfully connected to Kafka
[2025-06-09T17:24:06.206+0000] {subprocess.py:93} INFO - üöÄ Starting traffic simulation for 60 seconds at 5 events/second
[2025-06-09T17:24:06.210+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14728)
[2025-06-09T17:24:06.212+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1607)
[2025-06-09T17:24:06.218+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14729)
[2025-06-09T17:24:06.222+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14730)
[2025-06-09T17:24:06.223+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14731)
[2025-06-09T17:24:06.230+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14732)
[2025-06-09T17:24:06.231+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14733)
[2025-06-09T17:24:06.232+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14734)
[2025-06-09T17:24:06.236+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14735)
[2025-06-09T17:24:06.237+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14736)
[2025-06-09T17:24:06.239+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14737)
[2025-06-09T17:24:06.241+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14738)
[2025-06-09T17:24:06.244+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4204)
[2025-06-09T17:24:06.245+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14739)
[2025-06-09T17:24:06.246+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14740)
[2025-06-09T17:24:06.247+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14741)
[2025-06-09T17:24:06.248+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1608)
[2025-06-09T17:24:06.249+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14742)
[2025-06-09T17:24:06.250+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14743)
[2025-06-09T17:24:06.250+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14744)
[2025-06-09T17:24:06.251+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4205)
[2025-06-09T17:24:06.253+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4206)
[2025-06-09T17:24:06.258+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14745)
[2025-06-09T17:24:06.258+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14746)
[2025-06-09T17:24:06.259+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14747)
[2025-06-09T17:24:06.260+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14748)
[2025-06-09T17:24:06.261+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14749)
[2025-06-09T17:24:06.261+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1609)
[2025-06-09T17:24:06.262+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4207)
[2025-06-09T17:24:06.263+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4208)
[2025-06-09T17:24:06.264+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4209)
[2025-06-09T17:24:06.267+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14750)
[2025-06-09T17:24:06.268+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4210)
[2025-06-09T17:24:06.269+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14751)
[2025-06-09T17:24:06.271+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14752)
[2025-06-09T17:24:06.277+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4211)
[2025-06-09T17:24:06.281+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14753)
[2025-06-09T17:24:06.282+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14754)
[2025-06-09T17:24:06.283+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14755)
[2025-06-09T17:24:06.283+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14756)
[2025-06-09T17:24:06.284+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14757)
[2025-06-09T17:24:06.289+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14758)
[2025-06-09T17:24:06.293+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14759)
[2025-06-09T17:24:06.294+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1610)
[2025-06-09T17:24:06.295+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1611)
[2025-06-09T17:24:06.297+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1612)
[2025-06-09T17:24:06.298+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14760)
[2025-06-09T17:24:06.299+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14761)
[2025-06-09T17:24:06.304+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14762)
[2025-06-09T17:24:06.305+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14763)
[2025-06-09T17:24:06.307+0000] {subprocess.py:93} INFO - üìä Progress: 10s elapsed, 50 events sent (5.0 events/sec)
[2025-06-09T17:24:06.308+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1613)
[2025-06-09T17:24:06.309+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.wishlist.add: add_to_wishlist (partition: 0, offset: 1614)
[2025-06-09T17:24:06.311+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14764)
[2025-06-09T17:24:06.315+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14765)
[2025-06-09T17:24:06.316+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4212)
[2025-06-09T17:24:06.317+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14766)
[2025-06-09T17:24:06.318+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14767)
[2025-06-09T17:24:06.318+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14768)
[2025-06-09T17:24:06.320+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.cart.add: add_to_cart (partition: 0, offset: 4213)
[2025-06-09T17:24:06.321+0000] {subprocess.py:93} INFO - ‚úÖ Sent to ecommerce.product.views: product_view (partition: 0, offset: 14769)
[2025-06-09T17:24:06.322+0000] {subprocess.py:93} INFO - üèÅ Simulation completed: 60 events in 397.8 seconds (0.2 events/sec)
[2025-06-09T17:24:06.324+0000] {subprocess.py:93} INFO - ‚úÖ Producer closed successfully
[2025-06-09T17:24:06.683+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T17:24:06.922+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=kafka_ecommerce_pipeline, task_id=run_kafka_producer, execution_date=20250609T171600, start_date=20250609T171727, end_date=20250609T172406
[2025-06-09T17:24:07.020+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T17:24:07.144+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
