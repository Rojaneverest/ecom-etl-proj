[2025-06-09T04:37:12.313+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T04:37:12.316+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T04:37:12.316+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T04:37:12.322+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_target_layer> on 2025-06-08 00:00:00+00:00
[2025-06-09T04:37:12.324+0000] {standard_task_runner.py:60} INFO - Started process 180 to run task
[2025-06-09T04:37:12.326+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_dag', 'run_target_layer', 'scheduled__2025-06-08T00:00:00+00:00', '--job-id', '72', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpcaycvb_h']
[2025-06-09T04:37:12.327+0000] {standard_task_runner.py:88} INFO - Job 72: Subtask run_target_layer
[2025-06-09T04:37:12.348+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [running]> on host 00dbf994ec97
[2025-06-09T04:37:12.396+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_dag' AIRFLOW_CTX_TASK_ID='run_target_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-08T00:00:00+00:00'
[2025-06-09T04:37:12.397+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T04:37:12.398+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ecom_etl && python target_layer.py']
[2025-06-09T04:37:12.403+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T04:37:12.858+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:12,858 - snowflake_dwh_script - INFO - --- Starting Snowflake DWH Load Script ---
[2025-06-09T04:37:12.859+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:12,858 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.34
[2025-06-09T04:37:12.859+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:12,858 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-06-09T04:37:14.217+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,217 - snowflake_dwh_script - INFO - Successfully connected to Snowflake.
[2025-06-09T04:37:14.219+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,217 - snowflake_dwh_script - INFO - Ensuring database 'ECOM_DWH' and schema 'PUBLIC' exist...
[2025-06-09T04:37:14.220+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,217 - snowflake.connector.cursor - INFO - query: [CREATE DATABASE IF NOT EXISTS ECOM_DWH;]
[2025-06-09T04:37:14.551+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,550 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:14.552+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,551 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:14.553+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,551 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:14.553+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,551 - snowflake.connector.cursor - INFO - query: [CREATE SCHEMA IF NOT EXISTS ECOM_DWH.PUBLIC;]
[2025-06-09T04:37:14.890+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,890 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:14.892+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,890 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:14.892+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,890 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:14.893+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:14,891 - snowflake.connector.cursor - INFO - query: [USE DATABASE ECOM_DWH;]
[2025-06-09T04:37:15.230+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,230 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:15.231+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,230 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:15.231+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,230 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:15.232+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,230 - snowflake.connector.cursor - INFO - query: [USE SCHEMA PUBLIC;]
[2025-06-09T04:37:15.577+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,576 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:15.578+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,577 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:15.581+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,577 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:15.582+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,578 - snowflake_dwh_script - INFO - Creating DWH tables in the correct order...
[2025-06-09T04:37:15.583+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,578 - snowflake_dwh_script - INFO - Creating table: DWH_GEOLOCATION...
[2025-06-09T04:37:15.583+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:15,578 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_GEOLOCATION ( GEOLOCATION_ID NUMBER ...]
[2025-06-09T04:37:16.045+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,044 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:16.046+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,045 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:16.046+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,045 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:16.046+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,045 - snowflake_dwh_script - INFO - Creating table: DWH_PRODUCTS...
[2025-06-09T04:37:16.047+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,045 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_PRODUCTS ( PRODUCT_ID VARCHAR NOT NU...]
[2025-06-09T04:37:16.530+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,530 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:16.531+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,530 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:16.531+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,530 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:16.531+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,530 - snowflake_dwh_script - INFO - Creating table: DWH_CUSTOMERS...
[2025-06-09T04:37:16.531+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,531 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_CUSTOMERS ( CUSTOMER_ID VARCHAR NOT ...]
[2025-06-09T04:37:16.971+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,971 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:16.972+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,971 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:16.972+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,971 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:16.972+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,971 - snowflake_dwh_script - INFO - Creating table: DWH_SELLERS...
[2025-06-09T04:37:16.972+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:16,971 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_SELLERS ( SELLER_ID VARCHAR NOT NULL...]
[2025-06-09T04:37:17.431+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,431 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:17.431+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,431 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:17.431+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,431 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:17.432+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,431 - snowflake_dwh_script - INFO - Creating table: DWH_ORDERS...
[2025-06-09T04:37:17.432+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,431 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDERS ( ORDER_ID VARCHAR NOT NULL P...]
[2025-06-09T04:37:17.916+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,915 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:17.917+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,915 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:17.917+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,916 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:17.917+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,916 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_ITEMS...
[2025-06-09T04:37:17.917+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:17,916 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS ( ORDER_ID VARCHAR NOT N...]
[2025-06-09T04:37:18.518+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,518 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:18.520+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,518 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:18.520+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,518 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:18.521+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,519 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_PAYMENTS...
[2025-06-09T04:37:18.521+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,519 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS ( ORDER_ID VARCHAR NO...]
[2025-06-09T04:37:18.988+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,987 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:18.990+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,988 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:18.992+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,988 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:18.992+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,988 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_REVIEWS...
[2025-06-09T04:37:18.993+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:18,988 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS ( REVIEW_ID VARCHAR NO...]
[2025-06-09T04:37:19.471+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,471 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:19.472+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,471 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:19.473+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,471 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:19.473+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,472 - snowflake_dwh_script - INFO - --- Starting Data Load from Staging to DWH ---
[2025-06-09T04:37:19.473+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,472 - snowflake_dwh_script - INFO - Loading data from STG_GEOLOCATION into DWH_GEOLOCATION...
[2025-06-09T04:37:19.474+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,472 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_GEOLOCATION;]
[2025-06-09T04:37:19.808+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,808 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:19.810+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,809 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-09T04:37:19.810+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:19,809 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_GEOLOCATION (GEOLOCATION_ID, GEOLOCATION_ZIP_COD...]
[2025-06-09T04:37:21.055+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:21,054 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:21.056+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:21,055 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:21.057+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:21,055 - snowflake_dwh_script - INFO - Loading data from STG_PRODUCTS into DWH_PRODUCTS...
[2025-06-09T04:37:21.057+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:21,055 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_PRODUCTS;]
[2025-06-09T04:37:21.396+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:21,394 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:21.397+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:21,394 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T04:37:21.397+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:21,394 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_PRODUCTS (PRODUCT_ID, PRODUCT_CATEGORY_NAME, PRO...]
[2025-06-09T04:37:22.332+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:22,330 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:22.340+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:22,331 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:22.340+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:22,332 - snowflake_dwh_script - INFO - Loading data from STG_CUSTOMERS into DWH_CUSTOMERS...
[2025-06-09T04:37:22.341+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:22,333 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_CUSTOMERS;]
[2025-06-09T04:37:22.720+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:22,719 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:22.722+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:22,720 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-09T04:37:22.722+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:22,721 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_CUSTOMERS (CUSTOMER_ID, CUSTOMER_UNIQUE_ID, CUST...]
[2025-06-09T04:37:23.945+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:23,945 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:23.948+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:23,945 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:23.949+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:23,946 - snowflake_dwh_script - INFO - Loading data from STG_SELLERS into DWH_SELLERS...
[2025-06-09T04:37:23.950+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:23,946 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_SELLERS;]
[2025-06-09T04:37:24.355+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:24,355 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:24.356+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:24,355 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-09T04:37:24.357+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:24,356 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_SELLERS (SELLER_ID, SELLER_ZIP_CODE_PREFIX, SELL...]
[2025-06-09T04:37:25.171+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:25,170 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:25.173+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:25,171 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:25.174+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:25,171 - snowflake_dwh_script - INFO - Loading data from STG_ORDERS into DWH_ORDERS...
[2025-06-09T04:37:25.174+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:25,171 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDERS;]
[2025-06-09T04:37:25.528+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:25,527 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:25.529+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:25,528 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
[2025-06-09T04:37:25.530+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:25,529 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDERS (ORDER_ID, CUSTOMER_ID, ORDER_STATUS, ORD...]
[2025-06-09T04:37:26.717+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:26,717 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:26.719+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:26,718 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:26.719+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:26,718 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_ITEMS into DWH_ORDER_ITEMS...
[2025-06-09T04:37:26.720+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:26,718 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_ITEMS;]
[2025-06-09T04:37:27.123+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:27,122 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:27.124+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:27,123 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T04:37:27.125+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:27,123 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS (ORDER_ID, ORDER_ITEM_ID, PRODUCT_ID...]
[2025-06-09T04:37:28.265+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:28,264 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:28.269+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:28,265 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:28.269+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:28,265 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_PAYMENTS into DWH_ORDER_PAYMENTS...
[2025-06-09T04:37:28.269+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:28,265 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS;]
[2025-06-09T04:37:28.602+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:28,602 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:28.603+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:28,602 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-09T04:37:28.603+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:28,603 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS (ORDER_ID, PAYMENT_SEQUENTIAL, PA...]
[2025-06-09T04:37:29.587+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:29,587 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:29.588+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:29,587 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:29.588+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:29,587 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_REVIEWS into DWH_ORDER_REVIEWS...
[2025-06-09T04:37:29.589+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:29,587 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_REVIEWS;]
[2025-06-09T04:37:29.926+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:29,926 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:29.926+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:29,926 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T04:37:29.926+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:29,926 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS (REVIEW_ID, ORDER_ID, REVIEW_SCORE...]
[2025-06-09T04:37:31.097+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:31,096 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:31.098+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:31,097 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T04:37:31.100+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:31,097 - snowflake_dwh_script - INFO - --- Data Loading to DWH Finished ---
[2025-06-09T04:37:31.101+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:31,097 - snowflake.connector.connection - INFO - closed
[2025-06-09T04:37:31.415+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:31,415 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
[2025-06-09T04:37:31.734+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:31,734 - snowflake_dwh_script - INFO - Snowflake connection closed.
[2025-06-09T04:37:31.735+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:31,734 - snowflake_dwh_script - INFO - --- Snowflake DWH Load Script Finished Successfully ---
[2025-06-09T04:37:31.889+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T04:37:31.934+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_target_layer, execution_date=20250608T000000, start_date=20250609T043712, end_date=20250609T043731
[2025-06-09T04:37:32.006+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T04:37:32.031+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T08:13:48.312+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T08:13:48.316+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T08:13:48.316+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T08:13:48.322+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_target_layer> on 2025-06-08 00:00:00+00:00
[2025-06-09T08:13:48.326+0000] {standard_task_runner.py:60} INFO - Started process 297 to run task
[2025-06-09T08:13:48.333+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_dag', 'run_target_layer', 'scheduled__2025-06-08T00:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp7f50pzld']
[2025-06-09T08:13:48.334+0000] {standard_task_runner.py:88} INFO - Job 9: Subtask run_target_layer
[2025-06-09T08:13:48.381+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [running]> on host 958e4d9dc298
[2025-06-09T08:13:48.438+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_dag' AIRFLOW_CTX_TASK_ID='run_target_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-08T00:00:00+00:00'
[2025-06-09T08:13:48.440+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T08:13:48.446+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ecom_etl && python target_layer.py']
[2025-06-09T08:13:48.476+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T08:13:49.037+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:49,036 - snowflake_dwh_script - INFO - --- Starting Snowflake DWH Load Script ---
[2025-06-09T08:13:49.039+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:49,036 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.34
[2025-06-09T08:13:49.039+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:49,036 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-06-09T08:13:50.454+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:50,453 - snowflake_dwh_script - INFO - Successfully connected to Snowflake.
[2025-06-09T08:13:50.455+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:50,453 - snowflake_dwh_script - INFO - Ensuring database 'ECOM_DWH' and schema 'PUBLIC' exist...
[2025-06-09T08:13:50.456+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:50,453 - snowflake.connector.cursor - INFO - query: [CREATE DATABASE IF NOT EXISTS ECOM_DWH;]
[2025-06-09T08:13:50.737+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:50,737 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:50.738+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:50,737 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:50.738+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:50,737 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:50.739+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:50,737 - snowflake.connector.cursor - INFO - query: [CREATE SCHEMA IF NOT EXISTS ECOM_DWH.PUBLIC;]
[2025-06-09T08:13:51.029+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,029 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:51.031+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,030 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:51.032+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,030 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:51.033+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,030 - snowflake.connector.cursor - INFO - query: [USE DATABASE ECOM_DWH;]
[2025-06-09T08:13:51.321+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,320 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:51.321+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,321 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:51.322+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,321 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:51.322+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,321 - snowflake.connector.cursor - INFO - query: [USE SCHEMA PUBLIC;]
[2025-06-09T08:13:51.596+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,595 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:51.597+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,596 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:51.598+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,596 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:51.599+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,596 - snowflake_dwh_script - INFO - Creating DWH tables in the correct order...
[2025-06-09T08:13:51.600+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,596 - snowflake_dwh_script - INFO - Creating table: DWH_GEOLOCATION...
[2025-06-09T08:13:51.600+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,596 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_GEOLOCATION ( GEOLOCATION_ID NUMBER ...]
[2025-06-09T08:13:51.988+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,987 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:51.989+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,988 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:51.990+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,988 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:51.991+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,988 - snowflake_dwh_script - INFO - Creating table: DWH_PRODUCTS...
[2025-06-09T08:13:51.992+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:51,988 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_PRODUCTS ( PRODUCT_ID VARCHAR NOT NU...]
[2025-06-09T08:13:52.342+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,342 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:52.343+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,342 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:52.343+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,342 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:52.343+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,342 - snowflake_dwh_script - INFO - Creating table: DWH_CUSTOMERS...
[2025-06-09T08:13:52.344+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,342 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_CUSTOMERS ( CUSTOMER_ID VARCHAR NOT ...]
[2025-06-09T08:13:52.778+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,778 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:52.779+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,778 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:52.779+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,778 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:52.779+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,778 - snowflake_dwh_script - INFO - Creating table: DWH_SELLERS...
[2025-06-09T08:13:52.780+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:52,778 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_SELLERS ( SELLER_ID VARCHAR NOT NULL...]
[2025-06-09T08:13:53.152+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,151 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:53.153+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,152 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:53.153+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,152 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:53.153+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,152 - snowflake_dwh_script - INFO - Creating table: DWH_ORDERS...
[2025-06-09T08:13:53.153+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,152 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDERS ( ORDER_ID VARCHAR NOT NULL P...]
[2025-06-09T08:13:53.536+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,536 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:53.537+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,536 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:53.537+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,536 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:53.537+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,536 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_ITEMS...
[2025-06-09T08:13:53.538+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:53,536 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS ( ORDER_ID VARCHAR NOT N...]
[2025-06-09T08:13:54.045+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,044 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:54.046+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,045 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:54.046+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,045 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:54.046+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,045 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_PAYMENTS...
[2025-06-09T08:13:54.047+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,045 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS ( ORDER_ID VARCHAR NO...]
[2025-06-09T08:13:54.452+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,452 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:54.453+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,452 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:54.453+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,452 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:54.454+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,452 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_REVIEWS...
[2025-06-09T08:13:54.454+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,452 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS ( REVIEW_ID VARCHAR NO...]
[2025-06-09T08:13:54.893+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,893 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:54.895+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,893 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:54.895+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,893 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:54.896+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,893 - snowflake_dwh_script - INFO - --- Starting Data Load from Staging to DWH ---
[2025-06-09T08:13:54.896+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,893 - snowflake_dwh_script - INFO - Loading data from STG_GEOLOCATION into DWH_GEOLOCATION...
[2025-06-09T08:13:54.897+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:54,894 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_GEOLOCATION;]
[2025-06-09T08:13:55.192+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:55,191 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:55.193+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:55,192 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-09T08:13:55.193+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:55,193 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_GEOLOCATION (GEOLOCATION_ID, GEOLOCATION_ZIP_COD...]
[2025-06-09T08:13:56.364+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:56,363 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:56.369+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:56,364 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:56.370+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:56,364 - snowflake_dwh_script - INFO - Loading data from STG_PRODUCTS into DWH_PRODUCTS...
[2025-06-09T08:13:56.370+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:56,364 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_PRODUCTS;]
[2025-06-09T08:13:56.711+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:56,710 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:56.713+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:56,711 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T08:13:56.714+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:56,712 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_PRODUCTS (PRODUCT_ID, PRODUCT_CATEGORY_NAME, PRO...]
[2025-06-09T08:13:57.782+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:57,782 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:57.784+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:57,783 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:57.784+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:57,783 - snowflake_dwh_script - INFO - Loading data from STG_CUSTOMERS into DWH_CUSTOMERS...
[2025-06-09T08:13:57.785+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:57,783 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_CUSTOMERS;]
[2025-06-09T08:13:58.069+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:58,068 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:58.069+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:58,069 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-09T08:13:58.070+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:58,069 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_CUSTOMERS (CUSTOMER_ID, CUSTOMER_UNIQUE_ID, CUST...]
[2025-06-09T08:13:59.274+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:59,274 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:59.275+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:59,274 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:13:59.276+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:59,275 - snowflake_dwh_script - INFO - Loading data from STG_SELLERS into DWH_SELLERS...
[2025-06-09T08:13:59.276+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:59,275 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_SELLERS;]
[2025-06-09T08:13:59.552+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:59,552 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:59.553+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:59,552 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-09T08:13:59.553+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:59,552 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_SELLERS (SELLER_ID, SELLER_ZIP_CODE_PREFIX, SELL...]
[2025-06-09T08:14:00.276+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:00,275 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:00.278+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:00,276 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:14:00.279+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:00,276 - snowflake_dwh_script - INFO - Loading data from STG_ORDERS into DWH_ORDERS...
[2025-06-09T08:14:00.280+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:00,276 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDERS;]
[2025-06-09T08:14:00.600+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:00,600 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:00.601+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:00,600 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
[2025-06-09T08:14:00.602+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:00,600 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDERS (ORDER_ID, CUSTOMER_ID, ORDER_STATUS, ORD...]
[2025-06-09T08:14:01.728+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:01,727 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:01.730+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:01,727 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:14:01.731+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:01,728 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_ITEMS into DWH_ORDER_ITEMS...
[2025-06-09T08:14:01.733+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:01,728 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_ITEMS;]
[2025-06-09T08:14:02.015+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:02,014 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:02.017+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:02,015 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T08:14:02.018+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:02,015 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS (ORDER_ID, ORDER_ITEM_ID, PRODUCT_ID...]
[2025-06-09T08:14:03.057+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:03,057 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:03.058+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:03,057 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:14:03.059+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:03,057 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_PAYMENTS into DWH_ORDER_PAYMENTS...
[2025-06-09T08:14:03.059+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:03,057 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS;]
[2025-06-09T08:14:03.337+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:03,337 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:03.338+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:03,337 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-09T08:14:03.339+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:03,338 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS (ORDER_ID, PAYMENT_SEQUENTIAL, PA...]
[2025-06-09T08:14:04.190+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:04,190 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:04.191+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:04,190 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:14:04.192+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:04,190 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_REVIEWS into DWH_ORDER_REVIEWS...
[2025-06-09T08:14:04.192+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:04,190 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_REVIEWS;]
[2025-06-09T08:14:04.474+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:04,474 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:04.475+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:04,474 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T08:14:04.475+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:04,475 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS (REVIEW_ID, ORDER_ID, REVIEW_SCORE...]
[2025-06-09T08:14:05.640+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:05,638 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:14:05.646+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:05,639 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T08:14:05.646+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:05,640 - snowflake_dwh_script - INFO - --- Data Loading to DWH Finished ---
[2025-06-09T08:14:05.647+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:05,640 - snowflake.connector.connection - INFO - closed
[2025-06-09T08:14:05.904+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:05,904 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
[2025-06-09T08:14:06.178+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:06,177 - snowflake_dwh_script - INFO - Snowflake connection closed.
[2025-06-09T08:14:06.178+0000] {subprocess.py:93} INFO - 2025-06-09 08:14:06,178 - snowflake_dwh_script - INFO - --- Snowflake DWH Load Script Finished Successfully ---
[2025-06-09T08:14:06.362+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T08:14:06.412+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_target_layer, execution_date=20250608T000000, start_date=20250609T081348, end_date=20250609T081406
[2025-06-09T08:14:06.480+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T08:14:06.521+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T11:15:54.851+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T11:15:54.857+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T11:15:54.857+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T11:15:54.864+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_target_layer> on 2025-06-08 00:00:00+00:00
[2025-06-09T11:15:54.868+0000] {standard_task_runner.py:60} INFO - Started process 1305 to run task
[2025-06-09T11:15:54.871+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_dag', 'run_target_layer', 'scheduled__2025-06-08T00:00:00+00:00', '--job-id', '104', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp1slfyw4q']
[2025-06-09T11:15:54.872+0000] {standard_task_runner.py:88} INFO - Job 104: Subtask run_target_layer
[2025-06-09T11:15:54.936+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_dag.run_target_layer scheduled__2025-06-08T00:00:00+00:00 [running]> on host 2fcbbaba1dfb
[2025-06-09T11:15:54.988+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_dag' AIRFLOW_CTX_TASK_ID='run_target_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-08T00:00:00+00:00'
[2025-06-09T11:15:54.989+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T11:15:54.991+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ecom_etl && python target_layer.py']
[2025-06-09T11:15:54.999+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T11:15:55.664+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:55,661 - snowflake_dwh_script - INFO - --- Starting Snowflake DWH Load Script ---
[2025-06-09T11:15:55.671+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:55,662 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.34
[2025-06-09T11:15:55.672+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:55,662 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-06-09T11:15:56.988+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:56,987 - snowflake_dwh_script - INFO - Successfully connected to Snowflake.
[2025-06-09T11:15:56.990+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:56,987 - snowflake_dwh_script - INFO - Ensuring database 'ECOM_DWH' and schema 'PUBLIC' exist...
[2025-06-09T11:15:56.992+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:56,987 - snowflake.connector.cursor - INFO - query: [CREATE DATABASE IF NOT EXISTS ECOM_DWH;]
[2025-06-09T11:15:57.262+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,261 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:57.262+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,262 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:57.263+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,262 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:57.263+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,262 - snowflake.connector.cursor - INFO - query: [CREATE SCHEMA IF NOT EXISTS ECOM_DWH.PUBLIC;]
[2025-06-09T11:15:57.592+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,591 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:57.593+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,592 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:57.594+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,592 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:57.594+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,592 - snowflake.connector.cursor - INFO - query: [USE DATABASE ECOM_DWH;]
[2025-06-09T11:15:57.898+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,898 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:57.899+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,898 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:57.899+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,898 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:57.900+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:57,898 - snowflake.connector.cursor - INFO - query: [USE SCHEMA PUBLIC;]
[2025-06-09T11:15:58.209+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,208 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:58.211+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,209 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:58.211+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,209 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:58.212+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,209 - snowflake_dwh_script - INFO - Creating DWH tables in the correct order...
[2025-06-09T11:15:58.212+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,209 - snowflake_dwh_script - INFO - Creating table: DWH_GEOLOCATION...
[2025-06-09T11:15:58.213+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,210 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_GEOLOCATION ( GEOLOCATION_ID NUMBER ...]
[2025-06-09T11:15:58.585+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,585 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:58.586+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,585 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:58.586+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,585 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:58.586+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,585 - snowflake_dwh_script - INFO - Creating table: DWH_PRODUCTS...
[2025-06-09T11:15:58.587+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,585 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_PRODUCTS ( PRODUCT_ID VARCHAR NOT NU...]
[2025-06-09T11:15:58.940+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,939 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:58.941+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,939 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:58.942+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,940 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:58.942+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,940 - snowflake_dwh_script - INFO - Creating table: DWH_CUSTOMERS...
[2025-06-09T11:15:58.942+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:58,940 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_CUSTOMERS ( CUSTOMER_ID VARCHAR NOT ...]
[2025-06-09T11:15:59.342+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,341 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:59.343+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,342 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:59.343+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,342 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:59.343+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,342 - snowflake_dwh_script - INFO - Creating table: DWH_SELLERS...
[2025-06-09T11:15:59.344+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,342 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_SELLERS ( SELLER_ID VARCHAR NOT NULL...]
[2025-06-09T11:15:59.790+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,790 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:59.792+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,790 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:59.792+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,791 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:15:59.793+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,791 - snowflake_dwh_script - INFO - Creating table: DWH_ORDERS...
[2025-06-09T11:15:59.793+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:59,791 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDERS ( ORDER_ID VARCHAR NOT NULL P...]
[2025-06-09T11:16:00.177+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,176 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:00.177+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,177 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:16:00.178+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,177 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:00.178+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,177 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_ITEMS...
[2025-06-09T11:16:00.178+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,177 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS ( ORDER_ID VARCHAR NOT N...]
[2025-06-09T11:16:00.659+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,658 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:00.660+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,659 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:16:00.661+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,659 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:00.662+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,659 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_PAYMENTS...
[2025-06-09T11:16:00.662+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:00,659 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS ( ORDER_ID VARCHAR NO...]
[2025-06-09T11:16:01.054+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,053 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:01.055+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,054 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:16:01.055+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,054 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:01.055+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,054 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_REVIEWS...
[2025-06-09T11:16:01.056+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,054 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS ( REVIEW_ID VARCHAR NO...]
[2025-06-09T11:16:01.454+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,454 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:01.456+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,454 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:16:01.457+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,455 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:01.457+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,455 - snowflake_dwh_script - INFO - --- Starting Data Load from Staging to DWH ---
[2025-06-09T11:16:01.458+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,455 - snowflake_dwh_script - INFO - Loading data from STG_GEOLOCATION into DWH_GEOLOCATION...
[2025-06-09T11:16:01.458+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,455 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_GEOLOCATION;]
[2025-06-09T11:16:01.749+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,749 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:01.753+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,750 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-09T11:16:01.755+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:01,751 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_GEOLOCATION (GEOLOCATION_ID, GEOLOCATION_ZIP_COD...]
[2025-06-09T11:16:02.960+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:02,958 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:02.963+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:02,959 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:02.964+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:02,959 - snowflake_dwh_script - INFO - Loading data from STG_PRODUCTS into DWH_PRODUCTS...
[2025-06-09T11:16:02.964+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:02,959 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_PRODUCTS;]
[2025-06-09T11:16:03.277+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:03,267 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:03.290+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:03,268 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T11:16:03.292+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:03,269 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_PRODUCTS (PRODUCT_ID, PRODUCT_CATEGORY_NAME, PRO...]
[2025-06-09T11:16:04.051+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:04,049 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:04.053+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:04,050 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:04.053+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:04,050 - snowflake_dwh_script - INFO - Loading data from STG_CUSTOMERS into DWH_CUSTOMERS...
[2025-06-09T11:16:04.053+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:04,050 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_CUSTOMERS;]
[2025-06-09T11:16:04.358+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:04,358 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:04.359+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:04,358 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-09T11:16:04.359+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:04,359 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_CUSTOMERS (CUSTOMER_ID, CUSTOMER_UNIQUE_ID, CUST...]
[2025-06-09T11:16:05.497+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:05,495 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:05.503+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:05,496 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:05.504+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:05,496 - snowflake_dwh_script - INFO - Loading data from STG_SELLERS into DWH_SELLERS...
[2025-06-09T11:16:05.504+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:05,497 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_SELLERS;]
[2025-06-09T11:16:05.787+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:05,786 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:05.789+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:05,787 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-09T11:16:05.789+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:05,789 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_SELLERS (SELLER_ID, SELLER_ZIP_CODE_PREFIX, SELL...]
[2025-06-09T11:16:06.453+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:06,449 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:06.464+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:06,451 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:06.465+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:06,452 - snowflake_dwh_script - INFO - Loading data from STG_ORDERS into DWH_ORDERS...
[2025-06-09T11:16:06.465+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:06,452 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDERS;]
[2025-06-09T11:16:06.744+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:06,743 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:06.747+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:06,744 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
[2025-06-09T11:16:06.747+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:06,745 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDERS (ORDER_ID, CUSTOMER_ID, ORDER_STATUS, ORD...]
[2025-06-09T11:16:07.866+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:07,863 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:07.876+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:07,867 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:07.876+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:07,868 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_ITEMS into DWH_ORDER_ITEMS...
[2025-06-09T11:16:07.877+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:07,868 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_ITEMS;]
[2025-06-09T11:16:08.155+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:08,155 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:08.156+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:08,156 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T11:16:08.157+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:08,156 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS (ORDER_ID, ORDER_ITEM_ID, PRODUCT_ID...]
[2025-06-09T11:16:09.266+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:09,263 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:09.276+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:09,269 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:09.277+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:09,270 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_PAYMENTS into DWH_ORDER_PAYMENTS...
[2025-06-09T11:16:09.278+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:09,270 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS;]
[2025-06-09T11:16:09.556+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:09,554 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:09.559+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:09,555 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-09T11:16:09.562+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:09,559 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS (ORDER_ID, PAYMENT_SEQUENTIAL, PA...]
[2025-06-09T11:16:10.461+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:10,451 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:10.488+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:10,463 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:10.491+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:10,464 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_REVIEWS into DWH_ORDER_REVIEWS...
[2025-06-09T11:16:10.491+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:10,464 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_REVIEWS;]
[2025-06-09T11:16:10.771+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:10,770 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:10.773+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:10,771 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-09T11:16:10.773+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:10,772 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS (REVIEW_ID, ORDER_ID, REVIEW_SCORE...]
[2025-06-09T11:16:11.967+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:11,963 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:16:11.975+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:11,967 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-09T11:16:11.976+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:11,967 - snowflake_dwh_script - INFO - --- Data Loading to DWH Finished ---
[2025-06-09T11:16:11.976+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:11,967 - snowflake.connector.connection - INFO - closed
[2025-06-09T11:16:12.230+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:12,230 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
[2025-06-09T11:16:12.499+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:12,498 - snowflake_dwh_script - INFO - Snowflake connection closed.
[2025-06-09T11:16:12.502+0000] {subprocess.py:93} INFO - 2025-06-09 11:16:12,499 - snowflake_dwh_script - INFO - --- Snowflake DWH Load Script Finished Successfully ---
[2025-06-09T11:16:12.741+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T11:16:12.820+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_target_layer, execution_date=20250608T000000, start_date=20250609T111554, end_date=20250609T111612
[2025-06-09T11:16:12.895+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T11:16:12.973+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
