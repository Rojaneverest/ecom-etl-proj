[2025-06-09T04:36:51.051+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T04:36:51.055+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T04:36:51.055+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T04:36:51.061+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_staging_layer> on 2025-06-08 00:00:00+00:00
[2025-06-09T04:36:51.064+0000] {standard_task_runner.py:60} INFO - Started process 168 to run task
[2025-06-09T04:36:51.066+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_dag', 'run_staging_layer', 'scheduled__2025-06-08T00:00:00+00:00', '--job-id', '71', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpn39fquzb']
[2025-06-09T04:36:51.067+0000] {standard_task_runner.py:88} INFO - Job 71: Subtask run_staging_layer
[2025-06-09T04:36:51.092+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [running]> on host 00dbf994ec97
[2025-06-09T04:36:51.128+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_dag' AIRFLOW_CTX_TASK_ID='run_staging_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-08T00:00:00+00:00'
[2025-06-09T04:36:51.129+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T04:36:51.130+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ecom_etl && python staging_layer.py']
[2025-06-09T04:36:51.141+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T04:36:52.270+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:52,267 - snowflake_elt_script - INFO - --- Starting Snowflake ELT Script ---
[2025-06-09T04:36:52.274+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:52,267 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.34
[2025-06-09T04:36:52.274+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:52,267 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-06-09T04:36:53.463+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:53,462 - snowflake_elt_script - INFO - Successfully connected to Snowflake.
[2025-06-09T04:36:53.473+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:53,462 - snowflake_elt_script - INFO - Ensuring database 'ECOM_STG' and schema 'PUBLIC' exist...
[2025-06-09T04:36:53.473+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:53,462 - snowflake.connector.cursor - INFO - query: [CREATE DATABASE IF NOT EXISTS ECOM_STG;]
[2025-06-09T04:36:53.744+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:53,744 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:53.745+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:53,744 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:53.745+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:53,745 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:53.745+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:53,745 - snowflake.connector.cursor - INFO - query: [CREATE SCHEMA IF NOT EXISTS ECOM_STG.PUBLIC;]
[2025-06-09T04:36:54.043+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,043 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:54.044+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,043 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:54.044+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,043 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:54.044+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,043 - snowflake.connector.cursor - INFO - query: [USE DATABASE ECOM_STG;]
[2025-06-09T04:36:54.350+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,349 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:54.350+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,350 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:54.351+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,350 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:54.351+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,350 - snowflake.connector.cursor - INFO - query: [USE SCHEMA PUBLIC;]
[2025-06-09T04:36:54.639+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,638 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:54.640+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,638 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:54.641+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,638 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:54.641+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,639 - snowflake_elt_script - INFO - Creating staging tables in the correct order...
[2025-06-09T04:36:54.641+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,639 - snowflake_elt_script - INFO - Creating table: GEOLOCATION...
[2025-06-09T04:36:54.642+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:54,639 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_GEOLOCATION ( GEOLOCATION_ID NUMBER ...]
[2025-06-09T04:36:55.074+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,074 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:55.077+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,074 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:55.078+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,074 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:55.078+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,074 - snowflake_elt_script - INFO - Creating table: PRODUCT_CATEGORY_TRANSLATION...
[2025-06-09T04:36:55.078+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,074 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_PRODUCT_CATEGORY_TRANSLATION ( PRODU...]
[2025-06-09T04:36:55.455+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,454 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:55.455+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,455 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:55.456+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,455 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:55.456+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,455 - snowflake_elt_script - INFO - Creating table: PRODUCTS...
[2025-06-09T04:36:55.456+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,455 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_PRODUCTS ( PRODUCT_ID VARCHAR NOT NU...]
[2025-06-09T04:36:55.877+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,876 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:55.878+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,877 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:55.878+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,877 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:55.879+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,877 - snowflake_elt_script - INFO - Creating table: CUSTOMERS...
[2025-06-09T04:36:55.879+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:55,877 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_CUSTOMERS ( CUSTOMER_ID VARCHAR NOT ...]
[2025-06-09T04:36:56.377+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,377 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:56.378+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,378 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:56.379+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,378 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:56.379+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,378 - snowflake_elt_script - INFO - Creating table: SELLERS...
[2025-06-09T04:36:56.379+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,378 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_SELLERS ( SELLER_ID VARCHAR NOT NULL...]
[2025-06-09T04:36:56.801+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,800 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:56.802+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,801 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:56.802+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,801 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:56.803+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,801 - snowflake_elt_script - INFO - Creating table: ORDERS...
[2025-06-09T04:36:56.803+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:56,801 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDERS ( ORDER_ID VARCHAR NOT NULL P...]
[2025-06-09T04:36:57.219+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,216 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:57.221+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,218 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:57.222+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,218 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:57.222+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,219 - snowflake_elt_script - INFO - Creating table: ORDER_ITEMS...
[2025-06-09T04:36:57.223+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,219 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_ITEMS ( ORDER_ID VARCHAR NOT N...]
[2025-06-09T04:36:57.692+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,692 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:57.693+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,692 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:57.694+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,692 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:57.694+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,692 - snowflake_elt_script - INFO - Creating table: ORDER_PAYMENTS...
[2025-06-09T04:36:57.695+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:57,692 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS ( ORDER_ID VARCHAR NO...]
[2025-06-09T04:36:58.081+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,081 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:58.082+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,081 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:58.082+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,081 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:58.082+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,081 - snowflake_elt_script - INFO - Creating table: ORDER_REVIEWS...
[2025-06-09T04:36:58.082+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,081 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_REVIEWS ( REVIEW_ID VARCHAR NO...]
[2025-06-09T04:36:58.512+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,511 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:36:58.513+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,512 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:36:58.513+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,512 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:36:58.513+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,512 - snowflake_elt_script - INFO - --- Starting Data Transformation and Loading ---
[2025-06-09T04:36:58.514+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,512 - snowflake_elt_script - INFO - Transforming and loading GEOLOCATION...
[2025-06-09T04:36:58.514+0000] {subprocess.py:93} INFO - 2025-06-09 04:36:58,512 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_GEOLOCATION (GEOLOCATION_ZIP_CODE_PREFIX, GEOLOC...]
[2025-06-09T04:37:00.454+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:00,453 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:00.458+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:00,454 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:00.459+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:00,455 - snowflake_elt_script - INFO - Transforming and loading PRODUCT_CATEGORY_TRANSLATION...
[2025-06-09T04:37:00.459+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:00,455 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_PRODUCT_CATEGORY_TRANSLATION SELECT PRODUCT_CATE...]
[2025-06-09T04:37:01.057+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,057 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:01.058+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,057 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:01.058+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,057 - snowflake_elt_script - INFO - Transforming and loading PRODUCTS with null handling and category translation...
[2025-06-09T04:37:01.058+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,057 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_PRODUCTS WITH product_means AS ( SELECT AVG(PROD...]
[2025-06-09T04:37:01.922+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,922 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:01.923+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,922 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:01.924+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,922 - snowflake_elt_script - INFO - Creating temporary geolocation map...
[2025-06-09T04:37:01.924+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:01,922 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TEMPORARY TABLE geolocation_map AS SELECT GEOLOCATION_ZIP_CODE...]
[2025-06-09T04:37:02.851+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:02,851 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:02.852+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:02,851 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T04:37:02.852+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:02,851 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:02.853+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:02,851 - snowflake_elt_script - INFO - Creating fallback geolocation record...
[2025-06-09T04:37:02.853+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:02,851 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_GEOLOCATION (GEOLOCATION_ZIP_CODE_PREFIX, GEOLOC...]
[2025-06-09T04:37:03.472+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:03,471 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:03.476+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:03,472 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:03.477+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:03,472 - snowflake.connector.cursor - INFO - query: [INSERT INTO geolocation_map SELECT -1, GEOLOCATION_ID FROM ECOM_STG.PUBLIC.STG_G...]
[2025-06-09T04:37:04.199+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:04,199 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:04.200+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:04,199 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:04.200+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:04,199 - snowflake_elt_script - INFO - Transforming and loading CUSTOMERS with NULL handling...
[2025-06-09T04:37:04.200+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:04,199 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_CUSTOMERS SELECT c.CUSTOMER_ID, c.CUSTOMER_UNIQU...]
[2025-06-09T04:37:05.408+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:05,408 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:05.410+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:05,409 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:05.410+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:05,409 - snowflake_elt_script - INFO - Transforming and loading SELLERS with NULL handling...
[2025-06-09T04:37:05.411+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:05,409 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_SELLERS SELECT s.SELLER_ID, s.SELLER_ZIP_CODE_PR...]
[2025-06-09T04:37:06.230+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:06,229 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:06.231+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:06,230 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:06.231+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:06,230 - snowflake_elt_script - INFO - Transforming and loading ORDERS with NULL timestamp handling...
[2025-06-09T04:37:06.231+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:06,230 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDERS SELECT ORDER_ID, CUSTOMER_ID, ORDER_STATU...]
[2025-06-09T04:37:07.340+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:07,340 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:07.342+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:07,341 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:07.343+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:07,341 - snowflake_elt_script - INFO - Transforming and loading ORDER_ITEMS...
[2025-06-09T04:37:07.343+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:07,341 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_ITEMS SELECT ORDER_ID, ORDER_ITEM_ID, PROD...]
[2025-06-09T04:37:08.384+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:08,384 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:08.385+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:08,384 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:08.386+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:08,384 - snowflake_elt_script - INFO - Transforming and loading ORDER_PAYMENTS...
[2025-06-09T04:37:08.386+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:08,384 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS SELECT ORDER_ID, PAYMENT_SEQUENTI...]
[2025-06-09T04:37:09.301+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:09,301 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:09.303+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:09,301 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:09.304+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:09,301 - snowflake_elt_script - INFO - Transforming and loading ORDER_REVIEWS with null handling for comments...
[2025-06-09T04:37:09.304+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:09,301 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_REVIEWS SELECT REVIEW_ID, ORDER_ID, REVIEW...]
[2025-06-09T04:37:10.532+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:10,531 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T04:37:10.533+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:10,532 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T04:37:10.533+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:10,532 - snowflake_elt_script - INFO - --- Data Transformation and Loading Finished ---
[2025-06-09T04:37:10.534+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:10,532 - snowflake.connector.connection - INFO - closed
[2025-06-09T04:37:10.836+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:10,836 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
[2025-06-09T04:37:11.144+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:11,143 - snowflake_elt_script - INFO - Snowflake connection closed.
[2025-06-09T04:37:11.145+0000] {subprocess.py:93} INFO - 2025-06-09 04:37:11,144 - snowflake_elt_script - INFO - --- Snowflake ELT Script Finished Successfully ---
[2025-06-09T04:37:11.299+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T04:37:11.337+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_staging_layer, execution_date=20250608T000000, start_date=20250609T043651, end_date=20250609T043711
[2025-06-09T04:37:11.372+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T04:37:11.394+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T08:13:25.179+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T08:13:25.183+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T08:13:25.183+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T08:13:25.189+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_staging_layer> on 2025-06-08 00:00:00+00:00
[2025-06-09T08:13:25.192+0000] {standard_task_runner.py:60} INFO - Started process 270 to run task
[2025-06-09T08:13:25.194+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_dag', 'run_staging_layer', 'scheduled__2025-06-08T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpnubsgyr1']
[2025-06-09T08:13:25.195+0000] {standard_task_runner.py:88} INFO - Job 8: Subtask run_staging_layer
[2025-06-09T08:13:25.227+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [running]> on host 958e4d9dc298
[2025-06-09T08:13:25.294+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_dag' AIRFLOW_CTX_TASK_ID='run_staging_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-08T00:00:00+00:00'
[2025-06-09T08:13:25.296+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T08:13:25.297+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ecom_etl && python staging_layer.py']
[2025-06-09T08:13:25.303+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T08:13:26.007+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:26,006 - snowflake_elt_script - INFO - --- Starting Snowflake ELT Script ---
[2025-06-09T08:13:26.009+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:26,006 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.34
[2025-06-09T08:13:26.009+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:26,007 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-06-09T08:13:27.313+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,312 - snowflake_elt_script - INFO - Successfully connected to Snowflake.
[2025-06-09T08:13:27.315+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,312 - snowflake_elt_script - INFO - Ensuring database 'ECOM_STG' and schema 'PUBLIC' exist...
[2025-06-09T08:13:27.315+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,312 - snowflake.connector.cursor - INFO - query: [CREATE DATABASE IF NOT EXISTS ECOM_STG;]
[2025-06-09T08:13:27.633+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,633 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:27.633+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,633 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:27.634+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,633 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:27.634+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,633 - snowflake.connector.cursor - INFO - query: [CREATE SCHEMA IF NOT EXISTS ECOM_STG.PUBLIC;]
[2025-06-09T08:13:27.947+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,946 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:27.948+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,947 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:27.948+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,947 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:27.948+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:27,947 - snowflake.connector.cursor - INFO - query: [USE DATABASE ECOM_STG;]
[2025-06-09T08:13:28.268+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,268 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:28.269+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,268 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:28.270+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,268 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:28.270+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,268 - snowflake.connector.cursor - INFO - query: [USE SCHEMA PUBLIC;]
[2025-06-09T08:13:28.577+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,576 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:28.578+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,577 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:28.578+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,577 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:28.579+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,577 - snowflake_elt_script - INFO - Creating staging tables in the correct order...
[2025-06-09T08:13:28.579+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,577 - snowflake_elt_script - INFO - Creating table: GEOLOCATION...
[2025-06-09T08:13:28.580+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:28,577 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_GEOLOCATION ( GEOLOCATION_ID NUMBER ...]
[2025-06-09T08:13:29.008+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,008 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:29.009+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,008 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:29.009+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,008 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:29.010+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,008 - snowflake_elt_script - INFO - Creating table: PRODUCT_CATEGORY_TRANSLATION...
[2025-06-09T08:13:29.010+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,009 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_PRODUCT_CATEGORY_TRANSLATION ( PRODU...]
[2025-06-09T08:13:29.438+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,437 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:29.438+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,438 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:29.439+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,438 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:29.439+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,438 - snowflake_elt_script - INFO - Creating table: PRODUCTS...
[2025-06-09T08:13:29.440+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,438 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_PRODUCTS ( PRODUCT_ID VARCHAR NOT NU...]
[2025-06-09T08:13:29.859+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,859 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:29.860+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,860 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:29.861+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,860 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:29.861+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,860 - snowflake_elt_script - INFO - Creating table: CUSTOMERS...
[2025-06-09T08:13:29.862+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:29,860 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_CUSTOMERS ( CUSTOMER_ID VARCHAR NOT ...]
[2025-06-09T08:13:30.384+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,384 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:30.385+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,384 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:30.385+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,384 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:30.386+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,384 - snowflake_elt_script - INFO - Creating table: SELLERS...
[2025-06-09T08:13:30.386+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,385 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_SELLERS ( SELLER_ID VARCHAR NOT NULL...]
[2025-06-09T08:13:30.791+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,791 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:30.792+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,791 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:30.793+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,791 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:30.793+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,791 - snowflake_elt_script - INFO - Creating table: ORDERS...
[2025-06-09T08:13:30.794+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:30,791 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDERS ( ORDER_ID VARCHAR NOT NULL P...]
[2025-06-09T08:13:31.198+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,198 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:31.199+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,198 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:31.200+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,198 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:31.200+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,198 - snowflake_elt_script - INFO - Creating table: ORDER_ITEMS...
[2025-06-09T08:13:31.201+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,199 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_ITEMS ( ORDER_ID VARCHAR NOT N...]
[2025-06-09T08:13:31.656+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,655 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:31.657+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,656 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:31.657+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,656 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:31.658+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,656 - snowflake_elt_script - INFO - Creating table: ORDER_PAYMENTS...
[2025-06-09T08:13:31.658+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:31,656 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS ( ORDER_ID VARCHAR NO...]
[2025-06-09T08:13:32.114+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,114 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:32.116+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,114 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:32.116+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,114 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:32.116+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,114 - snowflake_elt_script - INFO - Creating table: ORDER_REVIEWS...
[2025-06-09T08:13:32.117+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,115 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_REVIEWS ( REVIEW_ID VARCHAR NO...]
[2025-06-09T08:13:32.546+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,545 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:32.548+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,546 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:32.548+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,546 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:32.549+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,546 - snowflake_elt_script - INFO - --- Starting Data Transformation and Loading ---
[2025-06-09T08:13:32.549+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,546 - snowflake_elt_script - INFO - Transforming and loading GEOLOCATION...
[2025-06-09T08:13:32.550+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:32,547 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_GEOLOCATION (GEOLOCATION_ZIP_CODE_PREFIX, GEOLOC...]
[2025-06-09T08:13:34.650+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:34,650 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:34.653+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:34,651 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:34.653+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:34,651 - snowflake_elt_script - INFO - Transforming and loading PRODUCT_CATEGORY_TRANSLATION...
[2025-06-09T08:13:34.654+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:34,652 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_PRODUCT_CATEGORY_TRANSLATION SELECT PRODUCT_CATE...]
[2025-06-09T08:13:35.340+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:35,339 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:35.341+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:35,340 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:35.341+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:35,340 - snowflake_elt_script - INFO - Transforming and loading PRODUCTS with null handling and category translation...
[2025-06-09T08:13:35.341+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:35,340 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_PRODUCTS WITH product_means AS ( SELECT AVG(PROD...]
[2025-06-09T08:13:36.272+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:36,271 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:36.273+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:36,271 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:36.274+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:36,271 - snowflake_elt_script - INFO - Creating temporary geolocation map...
[2025-06-09T08:13:36.274+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:36,271 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TEMPORARY TABLE geolocation_map AS SELECT GEOLOCATION_ZIP_CODE...]
[2025-06-09T08:13:37.350+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:37,347 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:37.352+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:37,352 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T08:13:37.352+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:37,352 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:37.357+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:37,355 - snowflake_elt_script - INFO - Creating fallback geolocation record...
[2025-06-09T08:13:37.359+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:37,355 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_GEOLOCATION (GEOLOCATION_ZIP_CODE_PREFIX, GEOLOC...]
[2025-06-09T08:13:38.168+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:38,167 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:38.169+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:38,169 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:38.170+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:38,169 - snowflake.connector.cursor - INFO - query: [INSERT INTO geolocation_map SELECT -1, GEOLOCATION_ID FROM ECOM_STG.PUBLIC.STG_G...]
[2025-06-09T08:13:38.992+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:38,991 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:38.992+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:38,992 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:38.993+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:38,992 - snowflake_elt_script - INFO - Transforming and loading CUSTOMERS with NULL handling...
[2025-06-09T08:13:38.993+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:38,992 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_CUSTOMERS SELECT c.CUSTOMER_ID, c.CUSTOMER_UNIQU...]
[2025-06-09T08:13:40.106+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:40,106 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:40.108+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:40,106 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:40.109+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:40,106 - snowflake_elt_script - INFO - Transforming and loading SELLERS with NULL handling...
[2025-06-09T08:13:40.109+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:40,106 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_SELLERS SELECT s.SELLER_ID, s.SELLER_ZIP_CODE_PR...]
[2025-06-09T08:13:41.034+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:41,033 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:41.034+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:41,034 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:41.035+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:41,034 - snowflake_elt_script - INFO - Transforming and loading ORDERS with NULL timestamp handling...
[2025-06-09T08:13:41.035+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:41,034 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDERS SELECT ORDER_ID, CUSTOMER_ID, ORDER_STATU...]
[2025-06-09T08:13:42.263+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:42,263 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:42.264+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:42,263 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:42.265+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:42,263 - snowflake_elt_script - INFO - Transforming and loading ORDER_ITEMS...
[2025-06-09T08:13:42.265+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:42,263 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_ITEMS SELECT ORDER_ID, ORDER_ITEM_ID, PROD...]
[2025-06-09T08:13:43.412+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:43,412 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:43.414+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:43,413 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:43.415+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:43,413 - snowflake_elt_script - INFO - Transforming and loading ORDER_PAYMENTS...
[2025-06-09T08:13:43.415+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:43,413 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS SELECT ORDER_ID, PAYMENT_SEQUENTI...]
[2025-06-09T08:13:44.418+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:44,416 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:44.423+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:44,418 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:44.424+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:44,418 - snowflake_elt_script - INFO - Transforming and loading ORDER_REVIEWS with null handling for comments...
[2025-06-09T08:13:44.424+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:44,418 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_REVIEWS SELECT REVIEW_ID, ORDER_ID, REVIEW...]
[2025-06-09T08:13:46.368+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:46,366 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T08:13:46.374+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:46,367 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T08:13:46.374+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:46,367 - snowflake_elt_script - INFO - --- Data Transformation and Loading Finished ---
[2025-06-09T08:13:46.375+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:46,367 - snowflake.connector.connection - INFO - closed
[2025-06-09T08:13:46.665+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:46,665 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
[2025-06-09T08:13:46.963+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:46,962 - snowflake_elt_script - INFO - Snowflake connection closed.
[2025-06-09T08:13:46.963+0000] {subprocess.py:93} INFO - 2025-06-09 08:13:46,962 - snowflake_elt_script - INFO - --- Snowflake ELT Script Finished Successfully ---
[2025-06-09T08:13:47.108+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T08:13:47.154+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_staging_layer, execution_date=20250608T000000, start_date=20250609T081325, end_date=20250609T081347
[2025-06-09T08:13:47.212+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T08:13:47.242+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T11:15:31.698+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T11:15:31.706+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [queued]>
[2025-06-09T11:15:31.707+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T11:15:31.725+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_staging_layer> on 2025-06-08 00:00:00+00:00
[2025-06-09T11:15:31.732+0000] {standard_task_runner.py:60} INFO - Started process 1251 to run task
[2025-06-09T11:15:31.737+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_dag', 'run_staging_layer', 'scheduled__2025-06-08T00:00:00+00:00', '--job-id', '98', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp_k3roovw']
[2025-06-09T11:15:31.739+0000] {standard_task_runner.py:88} INFO - Job 98: Subtask run_staging_layer
[2025-06-09T11:15:31.800+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_dag.run_staging_layer scheduled__2025-06-08T00:00:00+00:00 [running]> on host 2fcbbaba1dfb
[2025-06-09T11:15:31.891+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_dag' AIRFLOW_CTX_TASK_ID='run_staging_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-08T00:00:00+00:00'
[2025-06-09T11:15:31.892+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T11:15:31.893+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ecom_etl && python staging_layer.py']
[2025-06-09T11:15:31.900+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T11:15:33.195+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:33,193 - snowflake_elt_script - INFO - --- Starting Snowflake ELT Script ---
[2025-06-09T11:15:33.203+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:33,194 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.34
[2025-06-09T11:15:33.205+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:33,194 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-06-09T11:15:34.603+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:34,600 - snowflake_elt_script - INFO - Successfully connected to Snowflake.
[2025-06-09T11:15:34.614+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:34,601 - snowflake_elt_script - INFO - Ensuring database 'ECOM_STG' and schema 'PUBLIC' exist...
[2025-06-09T11:15:34.615+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:34,601 - snowflake.connector.cursor - INFO - query: [CREATE DATABASE IF NOT EXISTS ECOM_STG;]
[2025-06-09T11:15:34.965+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:34,965 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:34.967+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:34,966 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:34.970+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:34,970 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:34.971+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:34,970 - snowflake.connector.cursor - INFO - query: [CREATE SCHEMA IF NOT EXISTS ECOM_STG.PUBLIC;]
[2025-06-09T11:15:35.291+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,290 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:35.294+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,290 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:35.295+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,291 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:35.296+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,291 - snowflake.connector.cursor - INFO - query: [USE DATABASE ECOM_STG;]
[2025-06-09T11:15:35.622+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,621 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:35.626+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,621 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:35.627+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,622 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:35.628+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,622 - snowflake.connector.cursor - INFO - query: [USE SCHEMA PUBLIC;]
[2025-06-09T11:15:35.999+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:35,998 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:36.001+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,000 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:36.002+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,001 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:36.002+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,001 - snowflake_elt_script - INFO - Creating staging tables in the correct order...
[2025-06-09T11:15:36.003+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,001 - snowflake_elt_script - INFO - Creating table: GEOLOCATION...
[2025-06-09T11:15:36.004+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,001 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_GEOLOCATION ( GEOLOCATION_ID NUMBER ...]
[2025-06-09T11:15:36.463+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,462 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:36.465+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,462 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:36.466+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,462 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:36.466+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,462 - snowflake_elt_script - INFO - Creating table: PRODUCT_CATEGORY_TRANSLATION...
[2025-06-09T11:15:36.466+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,462 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_PRODUCT_CATEGORY_TRANSLATION ( PRODU...]
[2025-06-09T11:15:36.882+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,881 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:36.884+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,881 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:36.885+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,881 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:36.885+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,881 - snowflake_elt_script - INFO - Creating table: PRODUCTS...
[2025-06-09T11:15:36.885+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:36,882 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_PRODUCTS ( PRODUCT_ID VARCHAR NOT NU...]
[2025-06-09T11:15:37.330+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,330 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:37.333+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,330 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:37.336+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,330 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:37.340+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,330 - snowflake_elt_script - INFO - Creating table: CUSTOMERS...
[2025-06-09T11:15:37.340+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,331 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_CUSTOMERS ( CUSTOMER_ID VARCHAR NOT ...]
[2025-06-09T11:15:37.751+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,750 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:37.763+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,754 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:37.777+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,755 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:37.782+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,757 - snowflake_elt_script - INFO - Creating table: SELLERS...
[2025-06-09T11:15:37.790+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:37,757 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_SELLERS ( SELLER_ID VARCHAR NOT NULL...]
[2025-06-09T11:15:38.200+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,198 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:38.205+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,199 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:38.206+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,199 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:38.206+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,199 - snowflake_elt_script - INFO - Creating table: ORDERS...
[2025-06-09T11:15:38.206+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,199 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDERS ( ORDER_ID VARCHAR NOT NULL P...]
[2025-06-09T11:15:38.657+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,655 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:38.662+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,655 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:38.662+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,656 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:38.662+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,656 - snowflake_elt_script - INFO - Creating table: ORDER_ITEMS...
[2025-06-09T11:15:38.662+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:38,656 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_ITEMS ( ORDER_ID VARCHAR NOT N...]
[2025-06-09T11:15:39.280+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,274 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:39.290+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,278 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:39.290+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,280 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:39.291+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,280 - snowflake_elt_script - INFO - Creating table: ORDER_PAYMENTS...
[2025-06-09T11:15:39.292+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,281 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS ( ORDER_ID VARCHAR NO...]
[2025-06-09T11:15:39.723+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,722 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:39.723+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,723 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:39.723+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,723 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:39.724+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,723 - snowflake_elt_script - INFO - Creating table: ORDER_REVIEWS...
[2025-06-09T11:15:39.724+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:39,723 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_STG.PUBLIC.STG_ORDER_REVIEWS ( REVIEW_ID VARCHAR NO...]
[2025-06-09T11:15:40.170+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:40,169 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:40.172+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:40,170 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:40.172+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:40,170 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:40.172+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:40,170 - snowflake_elt_script - INFO - --- Starting Data Transformation and Loading ---
[2025-06-09T11:15:40.172+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:40,170 - snowflake_elt_script - INFO - Transforming and loading GEOLOCATION...
[2025-06-09T11:15:40.172+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:40,170 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_GEOLOCATION (GEOLOCATION_ZIP_CODE_PREFIX, GEOLOC...]
[2025-06-09T11:15:42.033+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,032 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:42.036+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,033 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:42.037+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,033 - snowflake_elt_script - INFO - Transforming and loading PRODUCT_CATEGORY_TRANSLATION...
[2025-06-09T11:15:42.037+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,033 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_PRODUCT_CATEGORY_TRANSLATION SELECT PRODUCT_CATE...]
[2025-06-09T11:15:42.693+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,693 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:42.694+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,693 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:42.694+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,693 - snowflake_elt_script - INFO - Transforming and loading PRODUCTS with null handling and category translation...
[2025-06-09T11:15:42.694+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:42,693 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_PRODUCTS WITH product_means AS ( SELECT AVG(PROD...]
[2025-06-09T11:15:43.670+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:43,670 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:43.673+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:43,670 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:43.673+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:43,670 - snowflake_elt_script - INFO - Creating temporary geolocation map...
[2025-06-09T11:15:43.674+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:43,671 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TEMPORARY TABLE geolocation_map AS SELECT GEOLOCATION_ZIP_CODE...]
[2025-06-09T11:15:44.588+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:44,586 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:44.594+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:44,588 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-09T11:15:44.595+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:44,588 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:44.595+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:44,588 - snowflake_elt_script - INFO - Creating fallback geolocation record...
[2025-06-09T11:15:44.595+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:44,588 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_GEOLOCATION (GEOLOCATION_ZIP_CODE_PREFIX, GEOLOC...]
[2025-06-09T11:15:45.300+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:45,300 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:45.302+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:45,300 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:45.302+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:45,301 - snowflake.connector.cursor - INFO - query: [INSERT INTO geolocation_map SELECT -1, GEOLOCATION_ID FROM ECOM_STG.PUBLIC.STG_G...]
[2025-06-09T11:15:46.029+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:46,028 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:46.030+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:46,029 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:46.031+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:46,029 - snowflake_elt_script - INFO - Transforming and loading CUSTOMERS with NULL handling...
[2025-06-09T11:15:46.031+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:46,029 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_CUSTOMERS SELECT c.CUSTOMER_ID, c.CUSTOMER_UNIQU...]
[2025-06-09T11:15:47.358+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:47,357 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:47.361+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:47,358 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:47.361+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:47,358 - snowflake_elt_script - INFO - Transforming and loading SELLERS with NULL handling...
[2025-06-09T11:15:47.361+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:47,359 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_SELLERS SELECT s.SELLER_ID, s.SELLER_ZIP_CODE_PR...]
[2025-06-09T11:15:48.394+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:48,392 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:48.399+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:48,394 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:48.399+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:48,394 - snowflake_elt_script - INFO - Transforming and loading ORDERS with NULL timestamp handling...
[2025-06-09T11:15:48.399+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:48,395 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDERS SELECT ORDER_ID, CUSTOMER_ID, ORDER_STATU...]
[2025-06-09T11:15:49.609+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:49,609 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:49.611+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:49,609 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:49.611+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:49,609 - snowflake_elt_script - INFO - Transforming and loading ORDER_ITEMS...
[2025-06-09T11:15:49.612+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:49,610 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_ITEMS SELECT ORDER_ID, ORDER_ITEM_ID, PROD...]
[2025-06-09T11:15:50.693+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:50,691 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:50.698+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:50,691 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:50.698+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:50,691 - snowflake_elt_script - INFO - Transforming and loading ORDER_PAYMENTS...
[2025-06-09T11:15:50.698+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:50,691 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS SELECT ORDER_ID, PAYMENT_SEQUENTI...]
[2025-06-09T11:15:51.653+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:51,653 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:51.655+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:51,653 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:51.655+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:51,653 - snowflake_elt_script - INFO - Transforming and loading ORDER_REVIEWS with null handling for comments...
[2025-06-09T11:15:51.655+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:51,654 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_STG.PUBLIC.STG_ORDER_REVIEWS SELECT REVIEW_ID, ORDER_ID, REVIEW...]
[2025-06-09T11:15:53.002+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:52,999 - snowflake.connector.cursor - INFO - query execution done
[2025-06-09T11:15:53.007+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:53,002 - snowflake_elt_script - INFO - Query executed successfully.
[2025-06-09T11:15:53.008+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:53,002 - snowflake_elt_script - INFO - --- Data Transformation and Loading Finished ---
[2025-06-09T11:15:53.008+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:53,002 - snowflake.connector.connection - INFO - closed
[2025-06-09T11:15:53.393+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:53,393 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
[2025-06-09T11:15:53.697+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:53,694 - snowflake_elt_script - INFO - Snowflake connection closed.
[2025-06-09T11:15:53.700+0000] {subprocess.py:93} INFO - 2025-06-09 11:15:53,694 - snowflake_elt_script - INFO - --- Snowflake ELT Script Finished Successfully ---
[2025-06-09T11:15:53.992+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T11:15:54.081+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_staging_layer, execution_date=20250608T000000, start_date=20250609T111531, end_date=20250609T111554
[2025-06-09T11:15:54.157+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T11:15:54.219+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
