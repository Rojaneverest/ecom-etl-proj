[2025-06-07T19:01:21.393+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_dag.run_target_layer manual__2025-06-07T18:59:52.017883+00:00 [queued]>
[2025-06-07T19:01:21.398+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_dag.run_target_layer manual__2025-06-07T18:59:52.017883+00:00 [queued]>
[2025-06-07T19:01:21.399+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-07T19:01:21.409+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_target_layer> on 2025-06-07 18:59:52.017883+00:00
[2025-06-07T19:01:21.412+0000] {standard_task_runner.py:60} INFO - Started process 422 to run task
[2025-06-07T19:01:21.415+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_dag', 'run_target_layer', 'manual__2025-06-07T18:59:52.017883+00:00', '--job-id', '48', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpox9ta9vh']
[2025-06-07T19:01:21.416+0000] {standard_task_runner.py:88} INFO - Job 48: Subtask run_target_layer
[2025-06-07T19:01:21.456+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_dag.run_target_layer manual__2025-06-07T18:59:52.017883+00:00 [running]> on host c183c35f0e34
[2025-06-07T19:01:21.520+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_dag' AIRFLOW_CTX_TASK_ID='run_target_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-06-07T18:59:52.017883+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-07T18:59:52.017883+00:00'
[2025-06-07T19:01:21.521+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-07T19:01:21.522+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ecom_etl && python target_layer.py']
[2025-06-07T19:01:21.530+0000] {subprocess.py:86} INFO - Output:
[2025-06-07T19:01:22.236+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:22,236 - snowflake_dwh_script - INFO - --- Starting Snowflake DWH Load Script ---
[2025-06-07T19:01:22.239+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:22,236 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.34
[2025-06-07T19:01:22.239+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:22,236 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-06-07T19:01:23.456+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:23,454 - snowflake_dwh_script - INFO - Successfully connected to Snowflake.
[2025-06-07T19:01:23.465+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:23,454 - snowflake_dwh_script - INFO - Ensuring database 'ECOM_DWH' and schema 'PUBLIC' exist...
[2025-06-07T19:01:23.466+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:23,455 - snowflake.connector.cursor - INFO - query: [CREATE DATABASE IF NOT EXISTS ECOM_DWH;]
[2025-06-07T19:01:23.751+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:23,750 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:23.754+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:23,751 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:23.755+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:23,752 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:23.756+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:23,752 - snowflake.connector.cursor - INFO - query: [CREATE SCHEMA IF NOT EXISTS ECOM_DWH.PUBLIC;]
[2025-06-07T19:01:24.027+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,027 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:24.028+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,027 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:24.028+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,027 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:24.028+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,027 - snowflake.connector.cursor - INFO - query: [USE DATABASE ECOM_DWH;]
[2025-06-07T19:01:24.589+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,589 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:24.590+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,589 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:24.590+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,589 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:24.591+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:24,589 - snowflake.connector.cursor - INFO - query: [USE SCHEMA PUBLIC;]
[2025-06-07T19:01:25.152+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,151 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:25.154+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,152 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:25.154+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,152 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:25.154+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,152 - snowflake_dwh_script - INFO - Creating DWH tables in the correct order...
[2025-06-07T19:01:25.154+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,152 - snowflake_dwh_script - INFO - Creating table: DWH_GEOLOCATION...
[2025-06-07T19:01:25.155+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,152 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_GEOLOCATION ( GEOLOCATION_ID NUMBER ...]
[2025-06-07T19:01:25.521+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,521 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:25.523+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,521 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:25.523+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,522 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:25.524+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,522 - snowflake_dwh_script - INFO - Creating table: DWH_PRODUCTS...
[2025-06-07T19:01:25.525+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,522 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_PRODUCTS ( PRODUCT_ID VARCHAR NOT NU...]
[2025-06-07T19:01:25.900+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,899 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:25.903+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,900 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:25.903+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,900 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:25.904+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,900 - snowflake_dwh_script - INFO - Creating table: DWH_CUSTOMERS...
[2025-06-07T19:01:25.904+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:25,900 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_CUSTOMERS ( CUSTOMER_ID VARCHAR NOT ...]
[2025-06-07T19:01:26.755+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:26,755 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:26.756+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:26,755 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:26.757+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:26,755 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:26.757+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:26,755 - snowflake_dwh_script - INFO - Creating table: DWH_SELLERS...
[2025-06-07T19:01:26.757+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:26,756 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_SELLERS ( SELLER_ID VARCHAR NOT NULL...]
[2025-06-07T19:01:27.723+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:27,723 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:27.724+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:27,723 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:27.724+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:27,723 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:27.724+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:27,723 - snowflake_dwh_script - INFO - Creating table: DWH_ORDERS...
[2025-06-07T19:01:27.724+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:27,723 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDERS ( ORDER_ID VARCHAR NOT NULL P...]
[2025-06-07T19:01:28.138+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:28,137 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:28.139+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:28,138 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:28.139+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:28,138 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:28.140+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:28,138 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_ITEMS...
[2025-06-07T19:01:28.140+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:28,138 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS ( ORDER_ID VARCHAR NOT N...]
[2025-06-07T19:01:29.202+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,199 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:29.207+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,201 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:29.207+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,201 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:29.208+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,202 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_PAYMENTS...
[2025-06-07T19:01:29.208+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,202 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS ( ORDER_ID VARCHAR NO...]
[2025-06-07T19:01:29.590+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,590 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:29.591+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,590 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:29.592+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,590 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:29.592+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,591 - snowflake_dwh_script - INFO - Creating table: DWH_ORDER_REVIEWS...
[2025-06-07T19:01:29.592+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:29,591 - snowflake.connector.cursor - INFO - query: [CREATE OR REPLACE TABLE ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS ( REVIEW_ID VARCHAR NO...]
[2025-06-07T19:01:30.119+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,119 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:30.121+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,119 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:30.122+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,119 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:30.122+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,120 - snowflake_dwh_script - INFO - --- Starting Data Load from Staging to DWH ---
[2025-06-07T19:01:30.123+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,120 - snowflake_dwh_script - INFO - Loading data from STG_GEOLOCATION into DWH_GEOLOCATION...
[2025-06-07T19:01:30.123+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,120 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_GEOLOCATION;]
[2025-06-07T19:01:30.401+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,401 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:30.402+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,401 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-07T19:01:30.403+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,402 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_GEOLOCATION;]
[2025-06-07T19:01:30.742+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,742 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:30.744+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,742 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:30.745+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:30,745 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_GEOLOCATION (GEOLOCATION_ID, GEOLOCATION_ZIP_COD...]
[2025-06-07T19:01:31.931+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:31,931 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:31.932+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:31,931 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:31.933+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:31,931 - snowflake_dwh_script - INFO - Loaded 719801 records into DWH_GEOLOCATION
[2025-06-07T19:01:31.934+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:31,932 - snowflake_dwh_script - INFO - Loading data from STG_PRODUCTS into DWH_PRODUCTS...
[2025-06-07T19:01:31.934+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:31,932 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_PRODUCTS;]
[2025-06-07T19:01:32.208+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:32,207 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:32.208+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:32,208 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-07T19:01:32.208+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:32,208 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_PRODUCTS;]
[2025-06-07T19:01:32.562+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:32,562 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:32.563+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:32,562 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:32.564+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:32,563 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_PRODUCTS (PRODUCT_ID, PRODUCT_CATEGORY_NAME, PRO...]
[2025-06-07T19:01:33.355+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,354 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:33.356+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,355 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:33.357+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,355 - snowflake_dwh_script - INFO - Loaded 32951 records into DWH_PRODUCTS
[2025-06-07T19:01:33.358+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,355 - snowflake_dwh_script - INFO - Loading data from STG_CUSTOMERS into DWH_CUSTOMERS...
[2025-06-07T19:01:33.358+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,355 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_CUSTOMERS;]
[2025-06-07T19:01:33.628+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,628 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:33.630+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,628 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
[2025-06-07T19:01:33.630+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,629 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_CUSTOMERS;]
[2025-06-07T19:01:33.955+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,954 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:33.956+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,955 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:33.956+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:33,955 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_CUSTOMERS (CUSTOMER_ID, CUSTOMER_UNIQUE_ID, CUST...]
[2025-06-07T19:01:35.014+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,012 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:35.017+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,014 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:35.017+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,014 - snowflake_dwh_script - INFO - Loaded 99441 records into DWH_CUSTOMERS
[2025-06-07T19:01:35.018+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,014 - snowflake_dwh_script - INFO - Loading data from STG_SELLERS into DWH_SELLERS...
[2025-06-07T19:01:35.018+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,014 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_SELLERS;]
[2025-06-07T19:01:35.304+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,304 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:35.305+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,304 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-07T19:01:35.305+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,305 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_SELLERS;]
[2025-06-07T19:01:35.678+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,677 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:35.679+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,678 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:35.679+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:35,678 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_SELLERS (SELLER_ID, SELLER_ZIP_CODE_PREFIX, SELL...]
[2025-06-07T19:01:36.529+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,528 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:36.530+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,529 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:36.531+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,529 - snowflake_dwh_script - INFO - Loaded 3095 records into DWH_SELLERS
[2025-06-07T19:01:36.532+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,529 - snowflake_dwh_script - INFO - Loading data from STG_ORDERS into DWH_ORDERS...
[2025-06-07T19:01:36.533+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,529 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDERS;]
[2025-06-07T19:01:36.803+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,802 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:36.804+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,803 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
[2025-06-07T19:01:36.804+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:36,804 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_ORDERS;]
[2025-06-07T19:01:37.150+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:37,150 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:37.151+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:37,150 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:37.152+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:37,151 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDERS (ORDER_ID, CUSTOMER_ID, ORDER_STATUS, ORD...]
[2025-06-07T19:01:38.374+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,374 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:38.376+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,375 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:38.377+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,375 - snowflake_dwh_script - INFO - Loaded 99441 records into DWH_ORDERS
[2025-06-07T19:01:38.377+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,375 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_ITEMS into DWH_ORDER_ITEMS...
[2025-06-07T19:01:38.378+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,375 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_ITEMS;]
[2025-06-07T19:01:38.658+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,657 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:38.659+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,658 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-07T19:01:38.659+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:38,658 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_ORDER_ITEMS;]
[2025-06-07T19:01:39.457+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:39,456 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:39.457+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:39,457 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:39.458+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:39,458 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_ITEMS (ORDER_ID, ORDER_ITEM_ID, PRODUCT_ID...]
[2025-06-07T19:01:46.286+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,281 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:46.300+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,286 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:46.301+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,286 - snowflake_dwh_script - INFO - Loaded 112650 records into DWH_ORDER_ITEMS
[2025-06-07T19:01:46.301+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,287 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_PAYMENTS into DWH_ORDER_PAYMENTS...
[2025-06-07T19:01:46.302+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,287 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS;]
[2025-06-07T19:01:46.569+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,569 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:46.570+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,569 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
[2025-06-07T19:01:46.570+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:46,570 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_ORDER_PAYMENTS;]
[2025-06-07T19:01:47.373+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:47,372 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:47.374+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:47,373 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:47.375+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:47,374 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_PAYMENTS (ORDER_ID, PAYMENT_SEQUENTIAL, PA...]
[2025-06-07T19:01:48.705+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:48,704 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:48.706+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:48,705 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:48.706+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:48,705 - snowflake_dwh_script - INFO - Loaded 103886 records into DWH_ORDER_PAYMENTS
[2025-06-07T19:01:48.707+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:48,705 - snowflake_dwh_script - INFO - Loading data from STG_ORDER_REVIEWS into DWH_ORDER_REVIEWS...
[2025-06-07T19:01:48.708+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:48,705 - snowflake.connector.cursor - INFO - query: [DESCRIBE TABLE ECOM_STG.PUBLIC.STG_ORDER_REVIEWS;]
[2025-06-07T19:01:49.579+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:49,579 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:49.580+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:49,579 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
[2025-06-07T19:01:49.580+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:49,579 - snowflake.connector.cursor - INFO - query: [SELECT COUNT(*) FROM ECOM_STG.PUBLIC.STG_ORDER_REVIEWS;]
[2025-06-07T19:01:49.958+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:49,957 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:49.959+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:49,958 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
[2025-06-07T19:01:49.960+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:49,958 - snowflake.connector.cursor - INFO - query: [INSERT INTO ECOM_DWH.PUBLIC.DWH_ORDER_REVIEWS (REVIEW_ID, ORDER_ID, REVIEW_SCORE...]
[2025-06-07T19:01:51.068+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:51,068 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:51.069+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:51,068 - snowflake_dwh_script - INFO - Query executed successfully.
[2025-06-07T19:01:51.070+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:51,068 - snowflake_dwh_script - INFO - Loaded 98410 records into DWH_ORDER_REVIEWS
[2025-06-07T19:01:51.070+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:51,068 - snowflake_dwh_script - INFO - --- Data Loading to DWH Finished ---
[2025-06-07T19:01:51.071+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:51,069 - snowflake_dwh_script - INFO - --- Starting Export to S3 as Parquet ---
[2025-06-07T19:01:51.071+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:51,069 - snowflake_dwh_script - INFO - Exporting DWH_GEOLOCATION to S3 as Parquet...
[2025-06-07T19:01:51.072+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:51,069 - snowflake.connector.cursor - INFO - query: [SELECT * FROM ECOM_DWH.PUBLIC.DWH_GEOLOCATION;]
[2025-06-07T19:01:52.904+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:52,900 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:01:52.918+0000] {subprocess.py:93} INFO - 2025-06-07 19:01:52,904 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2205
[2025-06-07T19:03:45.246+0000] {subprocess.py:93} INFO - 2025-06-07 19:03:45,241 - snowflake_dwh_script - INFO - Successfully exported DWH_GEOLOCATION to s3://rj-ecom-etl/processed/geolocation_20250607_190122.parquet
[2025-06-07T19:03:45.260+0000] {subprocess.py:93} INFO - 2025-06-07 19:03:45,242 - snowflake_dwh_script - INFO - Exported 719801 records from DWH_GEOLOCATION
[2025-06-07T19:03:45.646+0000] {subprocess.py:93} INFO - 2025-06-07 19:03:45,645 - snowflake_dwh_script - INFO - Exporting DWH_PRODUCTS to S3 as Parquet...
[2025-06-07T19:03:45.650+0000] {subprocess.py:93} INFO - 2025-06-07 19:03:45,650 - snowflake.connector.cursor - INFO - query: [SELECT * FROM ECOM_DWH.PUBLIC.DWH_PRODUCTS;]
[2025-06-07T19:03:48.380+0000] {subprocess.py:93} INFO - 2025-06-07 19:03:48,376 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:03:48.387+0000] {subprocess.py:93} INFO - 2025-06-07 19:03:48,383 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1157
[2025-06-07T19:04:02.670+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:02,660 - snowflake_dwh_script - INFO - Successfully exported DWH_PRODUCTS to s3://rj-ecom-etl/processed/products_20250607_190122.parquet
[2025-06-07T19:04:02.674+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:02,665 - snowflake_dwh_script - INFO - Exported 32951 records from DWH_PRODUCTS
[2025-06-07T19:04:02.697+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:02,696 - snowflake_dwh_script - INFO - Exporting DWH_CUSTOMERS to S3 as Parquet...
[2025-06-07T19:04:02.697+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:02,697 - snowflake.connector.cursor - INFO - query: [SELECT * FROM ECOM_DWH.PUBLIC.DWH_CUSTOMERS;]
[2025-06-07T19:04:06.765+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:06,763 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:04:06.769+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:06,766 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1074
[2025-06-07T19:04:15.088+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:15,078 - snowflake_dwh_script - INFO - Successfully exported DWH_CUSTOMERS to s3://rj-ecom-etl/processed/customers_20250607_190122.parquet
[2025-06-07T19:04:15.096+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:15,080 - snowflake_dwh_script - INFO - Exported 99441 records from DWH_CUSTOMERS
[2025-06-07T19:04:15.221+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:15,220 - snowflake_dwh_script - INFO - Exporting DWH_SELLERS to S3 as Parquet...
[2025-06-07T19:04:15.222+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:15,221 - snowflake.connector.cursor - INFO - query: [SELECT * FROM ECOM_DWH.PUBLIC.DWH_SELLERS;]
[2025-06-07T19:04:16.300+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:16,299 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:04:16.301+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:16,300 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1650
[2025-06-07T19:04:18.326+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:18,324 - snowflake_dwh_script - INFO - Successfully exported DWH_SELLERS to s3://rj-ecom-etl/processed/sellers_20250607_190122.parquet
[2025-06-07T19:04:18.330+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:18,324 - snowflake_dwh_script - INFO - Exported 3095 records from DWH_SELLERS
[2025-06-07T19:04:18.331+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:18,326 - snowflake_dwh_script - INFO - Exporting DWH_ORDERS to S3 as Parquet...
[2025-06-07T19:04:18.331+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:18,327 - snowflake.connector.cursor - INFO - query: [SELECT * FROM ECOM_DWH.PUBLIC.DWH_ORDERS;]
[2025-06-07T19:04:20.331+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:20,330 - snowflake.connector.cursor - INFO - query execution done
[2025-06-07T19:04:20.332+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:20,332 - snowflake.connector.cursor - INFO - Number of results in first chunk: 706
[2025-06-07T19:04:33.834+0000] {subprocess.py:93} INFO - 2025-06-07 19:04:33,819 - snowflake.connector.result_batch - ERROR - Failed to fetch the large result set batch data_0_0_6_1 for the 1 th time, backing off for 1s for the reason: 'HTTPSConnectionPool(host='sfc-va4-ds1-06-customer-stage.s3.amazonaws.com', port=443): Read timed out.'
[2025-06-07T19:04:33.839+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-07T19:04:33.839+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py", line 318, in recv_into
[2025-06-07T19:04:33.843+0000] {subprocess.py:93} INFO -     return self.connection.recv_into(*args, **kwargs)
[2025-06-07T19:04:33.843+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/OpenSSL/SSL.py", line 2108, in recv_into
[2025-06-07T19:04:33.843+0000] {subprocess.py:93} INFO -     self._raise_ssl_error(self._ssl, result)
[2025-06-07T19:04:33.843+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/OpenSSL/SSL.py", line 1810, in _raise_ssl_error
[2025-06-07T19:04:33.843+0000] {subprocess.py:93} INFO -     raise WantReadError()
[2025-06-07T19:04:33.843+0000] {subprocess.py:93} INFO - OpenSSL.SSL.WantReadError
[2025-06-07T19:04:33.843+0000] {subprocess.py:93} INFO - 
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO - 
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/response.py", line 444, in _error_catcher
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO -     yield
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/response.py", line 567, in read
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO -     data = self._fp_read(amt) if not fp_closed else b""
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/response.py", line 533, in _fp_read
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO -     return self._fp.read(amt) if amt is not None else self._fp.read()
[2025-06-07T19:04:33.844+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/http/client.py", line 459, in read
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO -     n = self.readinto(b)
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/http/client.py", line 503, in readinto
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO -     n = self.fp.readinto(b)
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/socket.py", line 669, in readinto
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO -     return self._sock.recv_into(b)
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py", line 331, in recv_into
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO -     raise timeout("The read operation timed out")
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO - socket.timeout: The read operation timed out
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO - 
[2025-06-07T19:04:33.845+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO - 
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/models.py", line 816, in generate
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -     yield from self.raw.stream(chunk_size, decode_content=True)
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/response.py", line 628, in stream
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -     data = self.read(amt=amt, decode_content=decode_content)
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/response.py", line 593, in read
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -     raise IncompleteRead(self._fp_bytes_read, self.length_remaining)
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -     self.gen.throw(type, value, traceback)
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/response.py", line 449, in _error_catcher
[2025-06-07T19:04:33.846+0000] {subprocess.py:93} INFO -     raise ReadTimeoutError(self._pool, None, "Read timed out.")
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO - snowflake.connector.vendored.urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='sfc-va4-ds1-06-customer-stage.s3.amazonaws.com', port=443): Read timed out.
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO - 
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO - 
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/result_batch.py", line 332, in _download
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO -     response = session.request("get", **request_data)
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 589, in request
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO -     resp = self.send(prep, **send_kwargs)
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 747, in send
[2025-06-07T19:04:33.847+0000] {subprocess.py:93} INFO -     r.content
[2025-06-07T19:04:33.848+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/models.py", line 899, in content
[2025-06-07T19:04:33.848+0000] {subprocess.py:93} INFO -     self._content = b"".join(self.iter_content(CONTENT_CHUNK_SIZE)) or b""
[2025-06-07T19:04:33.848+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/models.py", line 822, in generate
[2025-06-07T19:04:33.848+0000] {subprocess.py:93} INFO -     raise ConnectionError(e)
[2025-06-07T19:04:33.848+0000] {subprocess.py:93} INFO - snowflake.connector.vendored.requests.exceptions.ConnectionError: HTTPSConnectionPool(host='sfc-va4-ds1-06-customer-stage.s3.amazonaws.com', port=443): Read timed out.
[2025-06-07T19:04:38.209+0000] {subprocess.py:97} INFO - Command exited with return code -11
[2025-06-07T19:04:38.243+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code -11.
[2025-06-07T19:04:38.249+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=etl_dag, task_id=run_target_layer, execution_date=20250607T185952, start_date=20250607T190121, end_date=20250607T190438
[2025-06-07T19:04:38.264+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 48 for task run_target_layer (Bash command failed. The command returned a non-zero exit code -11.; 422)
[2025-06-07T19:04:38.304+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-06-07T19:04:38.335+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
