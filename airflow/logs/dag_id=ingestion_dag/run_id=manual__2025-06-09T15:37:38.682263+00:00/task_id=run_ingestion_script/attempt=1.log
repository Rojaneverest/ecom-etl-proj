[2025-06-09T15:37:40.301+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-09T15:37:38.682263+00:00 [queued]>
[2025-06-09T15:37:40.318+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-09T15:37:38.682263+00:00 [queued]>
[2025-06-09T15:37:40.318+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T15:37:40.341+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_ingestion_script> on 2025-06-09 15:37:38.682263+00:00
[2025-06-09T15:37:40.349+0000] {standard_task_runner.py:60} INFO - Started process 1926 to run task
[2025-06-09T15:37:40.358+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_dag', 'run_ingestion_script', 'manual__2025-06-09T15:37:38.682263+00:00', '--job-id', '275', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpyhn299gt']
[2025-06-09T15:37:40.360+0000] {standard_task_runner.py:88} INFO - Job 275: Subtask run_ingestion_script
[2025-06-09T15:37:40.462+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-09T15:37:38.682263+00:00 [running]> on host ed7c78a1ebb0
[2025-06-09T15:37:40.564+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_dag' AIRFLOW_CTX_TASK_ID='run_ingestion_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-09T15:37:38.682263+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-09T15:37:38.682263+00:00'
[2025-06-09T15:37:40.566+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T15:37:40.568+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ingestion && python ingestion_script.py']
[2025-06-09T15:37:40.590+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T15:37:41.505+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:41,503 - data_ingestion - INFO - AWS_REGION: eu-north-1
[2025-06-09T15:37:41.508+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:41,504 - data_ingestion - INFO - S3_BUCKET: rj-ecom-etl
[2025-06-09T15:37:41.509+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:41,505 - data_ingestion - INFO - AWS_ACCESS_KEY_ID: ***
[2025-06-09T15:37:41.509+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:41,506 - data_ingestion - INFO - AWS_SECRET_ACCESS_KEY: ***
[2025-06-09T15:37:41.510+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:41,508 - data_ingestion - INFO - Using provided AWS credentials
[2025-06-09T15:37:42.601+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:42,595 - data_ingestion - INFO - Successfully connected to AWS S3
[2025-06-09T15:37:42.606+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:42,597 - data_ingestion - INFO - Available buckets: ['rj-ecom-etl']
[2025-06-09T15:37:44.590+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:44,575 - data_ingestion - INFO - Bucket rj-ecom-etl already exists
[2025-06-09T15:37:44.604+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:44,584 - data_ingestion - INFO - Found 9 CSV files to process
[2025-06-09T15:37:44.605+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:44,585 - data_ingestion - INFO - Processing olist_sellers_dataset.csv...
[2025-06-09T15:37:44.640+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:44,639 - data_ingestion - INFO - Read 3095 rows from olist_sellers_dataset.csv
[2025-06-09T15:37:45.032+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:45,032 - data_ingestion - INFO - Validation complete: 3095 valid, 0 invalid
[2025-06-09T15:37:46.703+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:46,701 - data_ingestion - INFO - Uploaded 3095 valid records to s3://rj-ecom-etl/raw/olist_sellers_dataset/2025-06-09/olist_sellers_dataset.parquet
[2025-06-09T15:37:47.295+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:47,294 - data_ingestion - INFO - Processing product_category_name_translation.csv...
[2025-06-09T15:37:47.309+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:47,305 - data_ingestion - INFO - Read 71 rows from product_category_name_translation.csv
[2025-06-09T15:37:47.315+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:47,312 - data_ingestion - INFO - Validation complete: 71 valid, 0 invalid
[2025-06-09T15:37:47.930+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:47,929 - data_ingestion - INFO - Uploaded 71 valid records to s3://rj-ecom-etl/raw/product_category_name_translation/2025-06-09/product_category_name_translation.parquet
[2025-06-09T15:37:48.512+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:48,511 - data_ingestion - INFO - Processing olist_orders_dataset.csv...
[2025-06-09T15:37:48.955+0000] {subprocess.py:93} INFO - 2025-06-09 15:37:48,951 - data_ingestion - INFO - Read 99441 rows from olist_orders_dataset.csv
[2025-06-09T15:38:04.775+0000] {subprocess.py:93} INFO - 2025-06-09 15:38:04,773 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-09T15:38:56.051+0000] {subprocess.py:93} INFO - 2025-06-09 15:38:56,049 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_orders_dataset/2025-06-09/olist_orders_dataset.parquet
[2025-06-09T15:38:56.908+0000] {subprocess.py:93} INFO - 2025-06-09 15:38:56,904 - data_ingestion - INFO - Processing olist_order_items_dataset.csv...
[2025-06-09T15:38:57.101+0000] {subprocess.py:93} INFO - 2025-06-09 15:38:57,100 - data_ingestion - INFO - Read 112650 rows from olist_order_items_dataset.csv
[2025-06-09T15:39:10.348+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:10,344 - data_ingestion - INFO - Validation complete: 112650 valid, 0 invalid
[2025-06-09T15:39:22.907+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:22,902 - data_ingestion - INFO - Uploaded 112650 valid records to s3://rj-ecom-etl/raw/olist_order_items_dataset/2025-06-09/olist_order_items_dataset.parquet
[2025-06-09T15:39:23.686+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:23,684 - data_ingestion - INFO - Processing olist_customers_dataset.csv...
[2025-06-09T15:39:23.827+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:23,826 - data_ingestion - INFO - Read 99441 rows from olist_customers_dataset.csv
[2025-06-09T15:39:32.163+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:32,156 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-09T15:39:38.008+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:38,005 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_customers_dataset/2025-06-09/olist_customers_dataset.parquet
[2025-06-09T15:39:38.741+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:38,740 - data_ingestion - INFO - Processing olist_geolocation_dataset.csv...
[2025-06-09T15:39:40.525+0000] {subprocess.py:93} INFO - 2025-06-09 15:39:40,523 - data_ingestion - INFO - Read 1000163 rows from olist_geolocation_dataset.csv
[2025-06-09T15:41:10.425+0000] {subprocess.py:93} INFO - 2025-06-09 15:41:10,416 - data_ingestion - INFO - Validation complete: 1000163 valid, 0 invalid
[2025-06-09T15:42:09.992+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:09,986 - data_ingestion - INFO - Uploaded 1000163 valid records to s3://rj-ecom-etl/raw/olist_geolocation_dataset/2025-06-09/olist_geolocation_dataset.parquet
[2025-06-09T15:42:11.836+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:11,825 - data_ingestion - INFO - Processing olist_order_payments_dataset.csv...
[2025-06-09T15:42:12.013+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:12,012 - data_ingestion - INFO - Read 103886 rows from olist_order_payments_dataset.csv
[2025-06-09T15:42:21.122+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:21,118 - data_ingestion - INFO - Validation complete: 103886 valid, 0 invalid
[2025-06-09T15:42:26.480+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:26,470 - data_ingestion - INFO - Uploaded 103886 valid records to s3://rj-ecom-etl/raw/olist_order_payments_dataset/2025-06-09/olist_order_payments_dataset.parquet
[2025-06-09T15:42:27.226+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:27,225 - data_ingestion - INFO - Processing olist_order_reviews_dataset.csv...
[2025-06-09T15:42:27.476+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:27,475 - data_ingestion - INFO - Read 99224 rows from olist_order_reviews_dataset.csv
[2025-06-09T15:42:40.248+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:40,234 - data_ingestion - INFO - Validation complete: 99224 valid, 0 invalid
[2025-06-09T15:42:46.445+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:46,441 - data_ingestion - INFO - Uploaded 99224 valid records to s3://rj-ecom-etl/raw/olist_order_reviews_dataset/2025-06-09/olist_order_reviews_dataset.parquet
[2025-06-09T15:42:47.303+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:47,297 - data_ingestion - INFO - Processing olist_products_dataset.csv...
[2025-06-09T15:42:47.374+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:47,373 - data_ingestion - INFO - Read 32951 rows from olist_products_dataset.csv
[2025-06-09T15:42:52.122+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:52,117 - data_ingestion - INFO - Validation complete: 32951 valid, 0 invalid
[2025-06-09T15:42:52.971+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:52,970 - data_ingestion - INFO - Uploaded 32951 valid records to s3://rj-ecom-etl/raw/olist_products_dataset/2025-06-09/olist_products_dataset.parquet
[2025-06-09T15:42:53.616+0000] {subprocess.py:93} INFO - 2025-06-09 15:42:53,615 - data_ingestion - INFO - Data ingestion completed. Processed 9 out of 9 files successfully.
[2025-06-09T15:42:53.656+0000] {subprocess.py:93} INFO -          525253845 function calls (514961681 primitive calls) in 312.120 seconds
[2025-06-09T15:42:53.656+0000] {subprocess.py:93} INFO - 
[2025-06-09T15:42:53.659+0000] {subprocess.py:93} INFO -    Ordered by: cumulative time
[2025-06-09T15:42:53.659+0000] {subprocess.py:93} INFO -    List reduced from 2423 to 20 due to restriction <20>
[2025-06-09T15:42:53.660+0000] {subprocess.py:93} INFO - 
[2025-06-09T15:42:53.660+0000] {subprocess.py:93} INFO -    ncalls  tottime  percall  cumtime  percall filename:lineno(function)
[2025-06-09T15:42:53.660+0000] {subprocess.py:93} INFO -         1    2.159    2.159  312.119  312.119 ingestion_script.py:607(main)
[2025-06-09T15:42:53.660+0000] {subprocess.py:93} INFO -         9    7.311    0.812  306.881   34.098 ingestion_script.py:434(process_csv_file)
[2025-06-09T15:42:53.660+0000] {subprocess.py:93} INFO -        20    0.002    0.000  147.045    7.352 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:544(_api_call)
[2025-06-09T15:42:53.662+0000] {subprocess.py:93} INFO -        20    0.006    0.000  147.043    7.352 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:925(_make_api_call)
[2025-06-09T15:42:53.663+0000] {subprocess.py:93} INFO -        20    0.000    0.000  146.831    7.342 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:1013(_make_request)
[2025-06-09T15:42:53.664+0000] {subprocess.py:93} INFO -        20    0.000    0.000  146.831    7.342 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:113(make_request)
[2025-06-09T15:42:53.664+0000] {subprocess.py:93} INFO -        20    0.001    0.000  146.831    7.342 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:194(_send_request)
[2025-06-09T15:42:53.664+0000] {subprocess.py:93} INFO -        21    0.002    0.000  146.783    6.990 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:235(_get_response)
[2025-06-09T15:42:53.666+0000] {subprocess.py:93} INFO -        21    0.007    0.000  146.778    6.989 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:263(_do_get_response)
[2025-06-09T15:42:53.667+0000] {subprocess.py:93} INFO -        21    0.001    0.000  146.718    6.987 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:376(_send)
[2025-06-09T15:42:53.668+0000] {subprocess.py:93} INFO -        21    0.005    0.000  146.717    6.987 /home/***/.local/lib/python3.8/site-packages/botocore/httpsession.py:447(send)
[2025-06-09T15:42:53.668+0000] {subprocess.py:93} INFO -        21    0.004    0.000  146.668    6.984 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:534(urlopen)
[2025-06-09T15:42:53.669+0000] {subprocess.py:93} INFO -        21    0.009    0.000  146.634    6.983 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:379(_make_request)
[2025-06-09T15:42:53.669+0000] {subprocess.py:93} INFO -        21    0.002    0.000   87.025    4.144 /usr/local/lib/python3.8/http/client.py:1304(getresponse)
[2025-06-09T15:42:53.669+0000] {subprocess.py:93} INFO -        21    0.003    0.000   87.018    4.144 /usr/local/lib/python3.8/http/client.py:309(begin)
[2025-06-09T15:42:53.669+0000] {subprocess.py:93} INFO -        21    0.004    0.000   86.980    4.142 /usr/local/lib/python3.8/http/client.py:276(_read_status)
[2025-06-09T15:42:53.669+0000] {subprocess.py:93} INFO -       473    0.002    0.000   86.980    0.184 /usr/local/lib/python3.8/socket.py:655(readinto)
[2025-06-09T15:42:53.670+0000] {subprocess.py:93} INFO -       473    0.001    0.000   86.978    0.184 /usr/local/lib/python3.8/ssl.py:1263(recv_into)
[2025-06-09T15:42:53.670+0000] {subprocess.py:93} INFO -       246    0.002    0.000   86.977    0.354 {method 'readline' of '_io.BufferedReader' objects}
[2025-06-09T15:42:53.671+0000] {subprocess.py:93} INFO -       473    0.001    0.000   86.977    0.184 /usr/local/lib/python3.8/ssl.py:1123(read)
[2025-06-09T15:42:53.673+0000] {subprocess.py:93} INFO - 
[2025-06-09T15:42:53.674+0000] {subprocess.py:93} INFO - 
[2025-06-09T15:42:53.858+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-09T15:42:53.917+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=ingestion_dag, task_id=run_ingestion_script, execution_date=20250609T153738, start_date=20250609T153740, end_date=20250609T154253
[2025-06-09T15:42:53.958+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-09T15:42:53.991+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
