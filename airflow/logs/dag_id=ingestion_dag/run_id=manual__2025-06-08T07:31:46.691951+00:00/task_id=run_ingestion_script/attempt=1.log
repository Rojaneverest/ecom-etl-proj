[2025-06-08T07:31:47.905+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-08T07:31:46.691951+00:00 [queued]>
[2025-06-08T07:31:47.926+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-08T07:31:46.691951+00:00 [queued]>
[2025-06-08T07:31:47.926+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-08T07:31:47.954+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_ingestion_script> on 2025-06-08 07:31:46.691951+00:00
[2025-06-08T07:31:48.042+0000] {standard_task_runner.py:60} INFO - Started process 2820 to run task
[2025-06-08T07:31:48.054+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_dag', 'run_ingestion_script', 'manual__2025-06-08T07:31:46.691951+00:00', '--job-id', '171', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpzn6e1kwb']
[2025-06-08T07:31:48.064+0000] {standard_task_runner.py:88} INFO - Job 171: Subtask run_ingestion_script
[2025-06-08T07:31:48.300+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-08T07:31:46.691951+00:00 [running]> on host 677411ab3888
[2025-06-08T07:31:48.467+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_dag' AIRFLOW_CTX_TASK_ID='run_ingestion_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T07:31:46.691951+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-08T07:31:46.691951+00:00'
[2025-06-08T07:31:48.470+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-08T07:31:48.471+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ingestion && python ingestion_script.py']
[2025-06-08T07:31:48.492+0000] {subprocess.py:86} INFO - Output:
[2025-06-08T07:31:49.570+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:49,567 - data_ingestion - INFO - AWS_REGION: eu-north-1
[2025-06-08T07:31:49.577+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:49,568 - data_ingestion - INFO - S3_BUCKET: rj-ecom-etl
[2025-06-08T07:31:49.577+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:49,568 - data_ingestion - INFO - AWS_ACCESS_KEY_ID: ***
[2025-06-08T07:31:49.578+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:49,568 - data_ingestion - INFO - AWS_SECRET_ACCESS_KEY: ***
[2025-06-08T07:31:49.578+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:49,569 - data_ingestion - INFO - Using provided AWS credentials
[2025-06-08T07:31:50.655+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:50,654 - data_ingestion - INFO - Successfully connected to AWS S3
[2025-06-08T07:31:50.659+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:50,654 - data_ingestion - INFO - Available buckets: ['rj-ecom-etl']
[2025-06-08T07:31:54.657+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:54,654 - data_ingestion - INFO - Bucket rj-ecom-etl already exists
[2025-06-08T07:31:54.672+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:54,660 - data_ingestion - INFO - Found 9 CSV files to process
[2025-06-08T07:31:54.672+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:54,661 - data_ingestion - INFO - Processing olist_sellers_dataset.csv...
[2025-06-08T07:31:54.698+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:54,697 - data_ingestion - INFO - Read 3095 rows from olist_sellers_dataset.csv
[2025-06-08T07:31:54.930+0000] {subprocess.py:93} INFO - 2025-06-08 07:31:54,930 - data_ingestion - INFO - Validation complete: 3095 valid, 0 invalid
[2025-06-08T07:32:00.759+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:00,755 - data_ingestion - INFO - Uploaded 3095 valid records to s3://rj-ecom-etl/raw/olist_sellers_dataset/2025-06-08/olist_sellers_dataset.parquet
[2025-06-08T07:32:03.192+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:03,188 - data_ingestion - INFO - Processing product_category_name_translation.csv...
[2025-06-08T07:32:03.209+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:03,208 - data_ingestion - INFO - Read 71 rows from product_category_name_translation.csv
[2025-06-08T07:32:03.215+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:03,214 - data_ingestion - INFO - Validation complete: 71 valid, 0 invalid
[2025-06-08T07:32:05.624+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:05,621 - data_ingestion - INFO - Uploaded 71 valid records to s3://rj-ecom-etl/raw/product_category_name_translation/2025-06-08/product_category_name_translation.parquet
[2025-06-08T07:32:06.218+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:06,214 - data_ingestion - INFO - Processing olist_orders_dataset.csv...
[2025-06-08T07:32:07.183+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:07,181 - data_ingestion - INFO - Read 99441 rows from olist_orders_dataset.csv
[2025-06-08T07:32:24.538+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:24,529 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-08T07:32:31.204+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:31,201 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_orders_dataset/2025-06-08/olist_orders_dataset.parquet
[2025-06-08T07:32:32.676+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:32,672 - data_ingestion - INFO - Processing olist_order_items_dataset.csv...
[2025-06-08T07:32:32.987+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:32,987 - data_ingestion - INFO - Read 112650 rows from olist_order_items_dataset.csv
[2025-06-08T07:32:45.867+0000] {subprocess.py:93} INFO - 2025-06-08 07:32:45,860 - data_ingestion - INFO - Validation complete: 112650 valid, 0 invalid
[2025-06-08T07:33:32.476+0000] {subprocess.py:93} INFO - 2025-06-08 07:33:32,473 - data_ingestion - INFO - Uploaded 112650 valid records to s3://rj-ecom-etl/raw/olist_order_items_dataset/2025-06-08/olist_order_items_dataset.parquet
[2025-06-08T07:33:35.669+0000] {subprocess.py:93} INFO - 2025-06-08 07:33:35,666 - data_ingestion - INFO - Processing olist_customers_dataset.csv...
[2025-06-08T07:33:35.956+0000] {subprocess.py:93} INFO - 2025-06-08 07:33:35,956 - data_ingestion - INFO - Read 99441 rows from olist_customers_dataset.csv
[2025-06-08T07:33:43.650+0000] {subprocess.py:93} INFO - 2025-06-08 07:33:43,642 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-08T07:34:58.615+0000] {subprocess.py:93} INFO - 2025-06-08 07:34:58,611 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_customers_dataset/2025-06-08/olist_customers_dataset.parquet
[2025-06-08T07:35:00.214+0000] {subprocess.py:93} INFO - 2025-06-08 07:35:00,213 - data_ingestion - INFO - Processing olist_geolocation_dataset.csv...
[2025-06-08T07:35:02.104+0000] {subprocess.py:93} INFO - 2025-06-08 07:35:02,094 - data_ingestion - INFO - Read 1000163 rows from olist_geolocation_dataset.csv
[2025-06-08T07:36:40.814+0000] {subprocess.py:93} INFO - 2025-06-08 07:36:40,800 - data_ingestion - INFO - Validation complete: 1000163 valid, 0 invalid
[2025-06-08T07:37:07.677+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:07,668 - data_ingestion - INFO - Uploaded 1000163 valid records to s3://rj-ecom-etl/raw/olist_geolocation_dataset/2025-06-08/olist_geolocation_dataset.parquet
[2025-06-08T07:37:10.389+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:10,379 - data_ingestion - INFO - Processing olist_order_payments_dataset.csv...
[2025-06-08T07:37:11.117+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:11,108 - data_ingestion - INFO - Read 103886 rows from olist_order_payments_dataset.csv
[2025-06-08T07:37:21.116+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:21,113 - data_ingestion - INFO - Validation complete: 103886 valid, 0 invalid
[2025-06-08T07:37:33.371+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:33,367 - data_ingestion - INFO - Uploaded 103886 valid records to s3://rj-ecom-etl/raw/olist_order_payments_dataset/2025-06-08/olist_order_payments_dataset.parquet
[2025-06-08T07:37:34.121+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:34,120 - data_ingestion - INFO - Processing olist_order_reviews_dataset.csv...
[2025-06-08T07:37:34.486+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:34,485 - data_ingestion - INFO - Read 99224 rows from olist_order_reviews_dataset.csv
[2025-06-08T07:37:46.103+0000] {subprocess.py:93} INFO - 2025-06-08 07:37:46,092 - data_ingestion - INFO - Validation complete: 99224 valid, 0 invalid
[2025-06-08T07:38:00.179+0000] {subprocess.py:93} INFO - 2025-06-08 07:38:00,175 - data_ingestion - INFO - Uploaded 99224 valid records to s3://rj-ecom-etl/raw/olist_order_reviews_dataset/2025-06-08/olist_order_reviews_dataset.parquet
[2025-06-08T07:38:01.017+0000] {subprocess.py:93} INFO - 2025-06-08 07:38:01,016 - data_ingestion - INFO - Processing olist_products_dataset.csv...
[2025-06-08T07:38:01.108+0000] {subprocess.py:93} INFO - 2025-06-08 07:38:01,107 - data_ingestion - INFO - Read 32951 rows from olist_products_dataset.csv
[2025-06-08T07:38:05.577+0000] {subprocess.py:93} INFO - 2025-06-08 07:38:05,562 - data_ingestion - INFO - Validation complete: 32951 valid, 0 invalid
[2025-06-08T07:38:07.142+0000] {subprocess.py:93} INFO - 2025-06-08 07:38:07,140 - data_ingestion - INFO - Uploaded 32951 valid records to s3://rj-ecom-etl/raw/olist_products_dataset/2025-06-08/olist_products_dataset.parquet
[2025-06-08T07:38:07.782+0000] {subprocess.py:93} INFO - 2025-06-08 07:38:07,781 - data_ingestion - INFO - Data ingestion completed. Processed 9 out of 9 files successfully.
[2025-06-08T07:38:07.837+0000] {subprocess.py:93} INFO -          523647649 function calls (513355483 primitive calls) in 378.228 seconds
[2025-06-08T07:38:07.840+0000] {subprocess.py:93} INFO - 
[2025-06-08T07:38:07.840+0000] {subprocess.py:93} INFO -    Ordered by: cumulative time
[2025-06-08T07:38:07.840+0000] {subprocess.py:93} INFO -    List reduced from 2454 to 20 due to restriction <20>
[2025-06-08T07:38:07.841+0000] {subprocess.py:93} INFO - 
[2025-06-08T07:38:07.841+0000] {subprocess.py:93} INFO -    ncalls  tottime  percall  cumtime  percall filename:lineno(function)
[2025-06-08T07:38:07.841+0000] {subprocess.py:93} INFO -         1    3.177    3.177  378.225  378.225 ingestion_script.py:598(main)
[2025-06-08T07:38:07.841+0000] {subprocess.py:93} INFO -         9    7.924    0.880  369.955   41.106 ingestion_script.py:425(process_csv_file)
[2025-06-08T07:38:07.841+0000] {subprocess.py:93} INFO -        20    0.002    0.000  197.885    9.894 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:544(_api_call)
[2025-06-08T07:38:07.843+0000] {subprocess.py:93} INFO -        20    0.007    0.000  197.883    9.894 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:925(_make_api_call)
[2025-06-08T07:38:07.843+0000] {subprocess.py:93} INFO -        20    0.000    0.000  197.577    9.879 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:1013(_make_request)
[2025-06-08T07:38:07.843+0000] {subprocess.py:93} INFO -        20    0.000    0.000  197.577    9.879 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:113(make_request)
[2025-06-08T07:38:07.843+0000] {subprocess.py:93} INFO -        20    0.001    0.000  197.576    9.879 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:194(_send_request)
[2025-06-08T07:38:07.843+0000] {subprocess.py:93} INFO -        21    0.003    0.000  197.515    9.405 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:235(_get_response)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        21    0.009    0.000  197.508    9.405 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:263(_do_get_response)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        21    0.001    0.000  197.465    9.403 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:376(_send)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        21    0.009    0.000  197.463    9.403 /home/***/.local/lib/python3.8/site-packages/botocore/httpsession.py:447(send)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        21    0.008    0.000  197.408    9.400 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:534(urlopen)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        21    0.012    0.001  197.352    9.398 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:379(_make_request)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        21    0.008    0.000   95.112    4.529 /usr/local/lib/python3.8/http/client.py:1304(getresponse)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        21    0.005    0.000   95.092    4.528 /usr/local/lib/python3.8/http/client.py:309(begin)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -        27    0.006    0.000   95.049    3.520 /usr/local/lib/python3.8/http/client.py:276(_read_status)
[2025-06-08T07:38:07.844+0000] {subprocess.py:93} INFO -       329    0.003    0.000   95.046    0.289 /usr/local/lib/python3.8/socket.py:655(readinto)
[2025-06-08T07:38:07.845+0000] {subprocess.py:93} INFO -       258    0.002    0.000   95.044    0.368 {method 'readline' of '_io.BufferedReader' objects}
[2025-06-08T07:38:07.845+0000] {subprocess.py:93} INFO -       329    0.002    0.000   95.043    0.289 /usr/local/lib/python3.8/ssl.py:1263(recv_into)
[2025-06-08T07:38:07.845+0000] {subprocess.py:93} INFO -       329    0.001    0.000   95.041    0.289 /usr/local/lib/python3.8/ssl.py:1123(read)
[2025-06-08T07:38:07.845+0000] {subprocess.py:93} INFO - 
[2025-06-08T07:38:07.845+0000] {subprocess.py:93} INFO - 
[2025-06-08T07:38:08.387+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-08T07:38:08.536+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=ingestion_dag, task_id=run_ingestion_script, execution_date=20250608T073146, start_date=20250608T073147, end_date=20250608T073808
[2025-06-08T07:38:08.616+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-08T07:38:08.666+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
