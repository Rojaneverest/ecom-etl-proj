[2025-06-08T06:11:08.558+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script scheduled__2025-06-07T00:00:00+00:00 [queued]>
[2025-06-08T06:11:08.612+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script scheduled__2025-06-07T00:00:00+00:00 [queued]>
[2025-06-08T06:11:08.621+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-06-08T06:11:08.674+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_ingestion_script> on 2025-06-07 00:00:00+00:00
[2025-06-08T06:11:08.774+0000] {standard_task_runner.py:60} INFO - Started process 124 to run task
[2025-06-08T06:11:09.216+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_dag', 'run_ingestion_script', 'scheduled__2025-06-07T00:00:00+00:00', '--job-id', '83', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpdc3n4tuw']
[2025-06-08T06:11:09.468+0000] {standard_task_runner.py:88} INFO - Job 83: Subtask run_ingestion_script
[2025-06-08T06:11:11.150+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_dag.run_ingestion_script scheduled__2025-06-07T00:00:00+00:00 [running]> on host 677411ab3888
[2025-06-08T06:11:11.815+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_dag' AIRFLOW_CTX_TASK_ID='run_ingestion_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-07T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-07T00:00:00+00:00'
[2025-06-08T06:11:11.826+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-08T06:11:11.838+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ingestion && python ingestion_script.py']
[2025-06-08T06:11:12.140+0000] {subprocess.py:86} INFO - Output:
[2025-06-08T06:11:21.898+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:21,833 - data_ingestion - INFO - AWS_REGION: eu-north-1
[2025-06-08T06:11:21.987+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:21,834 - data_ingestion - INFO - S3_BUCKET: rj-ecom-etl
[2025-06-08T06:11:21.989+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:21,838 - data_ingestion - INFO - AWS_ACCESS_KEY_ID: ***
[2025-06-08T06:11:21.991+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:21,839 - data_ingestion - INFO - AWS_SECRET_ACCESS_KEY: ***
[2025-06-08T06:11:21.994+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:21,844 - data_ingestion - INFO - Using provided AWS credentials
[2025-06-08T06:11:28.879+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:28,804 - data_ingestion - INFO - Successfully connected to AWS S3
[2025-06-08T06:11:28.964+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:28,828 - data_ingestion - INFO - Available buckets: ['rj-ecom-etl']
[2025-06-08T06:11:32.089+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:32,058 - data_ingestion - INFO - Bucket rj-ecom-etl already exists
[2025-06-08T06:11:32.168+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:32,089 - data_ingestion - INFO - Found 9 CSV files to process
[2025-06-08T06:11:32.170+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:32,098 - data_ingestion - INFO - Processing olist_sellers_dataset.csv...
[2025-06-08T06:11:33.466+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:33,453 - data_ingestion - INFO - Read 3095 rows from olist_sellers_dataset.csv
[2025-06-08T06:11:34.159+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:34,151 - data_ingestion - INFO - Validation complete: 3095 valid, 0 invalid
[2025-06-08T06:11:36.078+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:36,070 - data_ingestion - INFO - Uploaded 3095 valid records to s3://rj-ecom-etl/raw/olist_sellers_dataset/2025-06-08/olist_sellers_dataset.parquet
[2025-06-08T06:11:36.941+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:36,934 - data_ingestion - INFO - Processing product_category_name_translation.csv...
[2025-06-08T06:11:36.990+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:36,989 - data_ingestion - INFO - Read 71 rows from product_category_name_translation.csv
[2025-06-08T06:11:37.004+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:37,002 - data_ingestion - INFO - Validation complete: 71 valid, 0 invalid
[2025-06-08T06:11:37.635+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:37,634 - data_ingestion - INFO - Uploaded 71 valid records to s3://rj-ecom-etl/raw/product_category_name_translation/2025-06-08/product_category_name_translation.parquet
[2025-06-08T06:11:38.706+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:38,698 - data_ingestion - INFO - Processing olist_orders_dataset.csv...
[2025-06-08T06:11:40.442+0000] {subprocess.py:93} INFO - 2025-06-08 06:11:40,413 - data_ingestion - INFO - Read 99441 rows from olist_orders_dataset.csv
[2025-06-08T06:12:01.768+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:01,759 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-08T06:12:18.192+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:18,180 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_orders_dataset/2025-06-08/olist_orders_dataset.parquet
[2025-06-08T06:12:19.105+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:19,102 - data_ingestion - INFO - Processing olist_order_items_dataset.csv...
[2025-06-08T06:12:19.313+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:19,312 - data_ingestion - INFO - Read 112650 rows from olist_order_items_dataset.csv
[2025-06-08T06:12:34.637+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:34,633 - data_ingestion - INFO - Validation complete: 112650 valid, 0 invalid
[2025-06-08T06:12:41.192+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:41,180 - data_ingestion - INFO - Uploaded 112650 valid records to s3://rj-ecom-etl/raw/olist_order_items_dataset/2025-06-08/olist_order_items_dataset.parquet
[2025-06-08T06:12:41.988+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:41,987 - data_ingestion - INFO - Processing olist_customers_dataset.csv...
[2025-06-08T06:12:42.198+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:42,197 - data_ingestion - INFO - Read 99441 rows from olist_customers_dataset.csv
[2025-06-08T06:12:53.094+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:53,087 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-08T06:12:57.334+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:57,330 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_customers_dataset/2025-06-08/olist_customers_dataset.parquet
[2025-06-08T06:12:58.019+0000] {subprocess.py:93} INFO - 2025-06-08 06:12:58,019 - data_ingestion - INFO - Processing olist_geolocation_dataset.csv...
[2025-06-08T06:13:01.881+0000] {subprocess.py:93} INFO - 2025-06-08 06:13:01,874 - data_ingestion - INFO - Read 1000163 rows from olist_geolocation_dataset.csv
[2025-06-08T06:14:47.302+0000] {subprocess.py:93} INFO - 2025-06-08 06:14:47,283 - data_ingestion - INFO - Validation complete: 1000163 valid, 0 invalid
[2025-06-08T06:15:08.075+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:08,062 - data_ingestion - INFO - Uploaded 1000163 valid records to s3://rj-ecom-etl/raw/olist_geolocation_dataset/2025-06-08/olist_geolocation_dataset.parquet
[2025-06-08T06:15:10.519+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:10,512 - data_ingestion - INFO - Processing olist_order_payments_dataset.csv...
[2025-06-08T06:15:10.783+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:10,781 - data_ingestion - INFO - Read 103886 rows from olist_order_payments_dataset.csv
[2025-06-08T06:15:19.675+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:19,671 - data_ingestion - INFO - Validation complete: 103886 valid, 0 invalid
[2025-06-08T06:15:29.787+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:29,781 - data_ingestion - INFO - Uploaded 103886 valid records to s3://rj-ecom-etl/raw/olist_order_payments_dataset/2025-06-08/olist_order_payments_dataset.parquet
[2025-06-08T06:15:30.520+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:30,518 - data_ingestion - INFO - Processing olist_order_reviews_dataset.csv...
[2025-06-08T06:15:30.762+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:30,762 - data_ingestion - INFO - Read 99224 rows from olist_order_reviews_dataset.csv
[2025-06-08T06:15:41.922+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:41,914 - data_ingestion - INFO - Validation complete: 99224 valid, 0 invalid
[2025-06-08T06:15:46.783+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:46,778 - data_ingestion - INFO - Uploaded 99224 valid records to s3://rj-ecom-etl/raw/olist_order_reviews_dataset/2025-06-08/olist_order_reviews_dataset.parquet
[2025-06-08T06:15:47.588+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:47,586 - data_ingestion - INFO - Processing olist_products_dataset.csv...
[2025-06-08T06:15:47.652+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:47,650 - data_ingestion - INFO - Read 32951 rows from olist_products_dataset.csv
[2025-06-08T06:15:51.409+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:51,406 - data_ingestion - INFO - Validation complete: 32951 valid, 0 invalid
[2025-06-08T06:15:52.673+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:52,672 - data_ingestion - INFO - Uploaded 32951 valid records to s3://rj-ecom-etl/raw/olist_products_dataset/2025-06-08/olist_products_dataset.parquet
[2025-06-08T06:15:53.543+0000] {subprocess.py:93} INFO - 2025-06-08 06:15:53,541 - data_ingestion - INFO - Data ingestion completed. Processed 9 out of 9 files successfully.
[2025-06-08T06:15:53.610+0000] {subprocess.py:93} INFO -          523649621 function calls (513357436 primitive calls) in 271.713 seconds
[2025-06-08T06:15:53.614+0000] {subprocess.py:93} INFO - 
[2025-06-08T06:15:53.615+0000] {subprocess.py:93} INFO -    Ordered by: cumulative time
[2025-06-08T06:15:53.615+0000] {subprocess.py:93} INFO -    List reduced from 2457 to 20 due to restriction <20>
[2025-06-08T06:15:53.615+0000] {subprocess.py:93} INFO - 
[2025-06-08T06:15:53.615+0000] {subprocess.py:93} INFO -    ncalls  tottime  percall  cumtime  percall filename:lineno(function)
[2025-06-08T06:15:53.615+0000] {subprocess.py:93} INFO -         1    2.801    2.801  271.708  271.708 ingestion_script.py:598(main)
[2025-06-08T06:15:53.615+0000] {subprocess.py:93} INFO -         9    8.526    0.947  258.640   28.738 ingestion_script.py:425(process_csv_file)
[2025-06-08T06:15:53.615+0000] {subprocess.py:93} INFO -   1550931    2.236    0.000   80.677    0.000 /home/***/.local/lib/python3.8/site-packages/pandas/core/frame.py:1354(iterrows)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO - 1551276/1551258    7.642    0.000   73.092    0.000 /home/***/.local/lib/python3.8/site-packages/pandas/core/series.py:368(__init__)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        20    0.003    0.000   71.907    3.595 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:544(_api_call)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        20    0.012    0.001   71.904    3.595 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:925(_make_api_call)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        20    0.000    0.000   71.456    3.573 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:1013(_make_request)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        20    0.000    0.000   71.455    3.573 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:113(make_request)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        20    0.002    0.000   71.455    3.573 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:194(_send_request)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        21    0.036    0.002   71.175    3.389 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:235(_get_response)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        21    0.030    0.001   71.116    3.386 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:263(_do_get_response)
[2025-06-08T06:15:53.617+0000] {subprocess.py:93} INFO -        21    0.002    0.000   70.849    3.374 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:376(_send)
[2025-06-08T06:15:53.618+0000] {subprocess.py:93} INFO -        21    0.010    0.000   70.847    3.374 /home/***/.local/lib/python3.8/site-packages/botocore/httpsession.py:447(send)
[2025-06-08T06:15:53.618+0000] {subprocess.py:93} INFO -        21    0.011    0.001   70.719    3.368 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:534(urlopen)
[2025-06-08T06:15:53.619+0000] {subprocess.py:93} INFO -        21    0.017    0.001   70.643    3.364 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:379(_make_request)
[2025-06-08T06:15:53.621+0000] {subprocess.py:93} INFO -   8605196    9.927    0.000   43.747    0.000 /home/***/.local/lib/python3.8/site-packages/pandas/core/series.py:992(__getitem__)
[2025-06-08T06:15:53.622+0000] {subprocess.py:93} INFO -        21    0.004    0.000   39.821    1.896 /home/***/.local/lib/python3.8/site-packages/botocore/awsrequest.py:87(request)
[2025-06-08T06:15:53.622+0000] {subprocess.py:93} INFO -        21    0.001    0.000   39.813    1.896 /home/***/.local/lib/python3.8/site-packages/urllib3/connection.py:231(request)
[2025-06-08T06:15:53.622+0000] {subprocess.py:93} INFO -        21    0.001    0.000   39.800    1.895 /usr/local/lib/python3.8/http/client.py:1253(request)
[2025-06-08T06:15:53.622+0000] {subprocess.py:93} INFO -        21    0.098    0.005   39.799    1.895 /usr/local/lib/python3.8/http/client.py:1258(_send_request)
[2025-06-08T06:15:53.622+0000] {subprocess.py:93} INFO - 
[2025-06-08T06:15:53.622+0000] {subprocess.py:93} INFO - 
[2025-06-08T06:15:54.126+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-08T06:15:54.330+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=ingestion_dag, task_id=run_ingestion_script, execution_date=20250607T000000, start_date=20250608T061108, end_date=20250608T061554
[2025-06-08T06:15:54.430+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-08T06:15:54.480+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
