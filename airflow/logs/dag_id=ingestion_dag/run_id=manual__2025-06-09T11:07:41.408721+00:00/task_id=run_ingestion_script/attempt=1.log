[2025-06-09T11:07:42.401+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-09T11:07:41.408721+00:00 [queued]>
[2025-06-09T11:07:42.408+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-09T11:07:41.408721+00:00 [queued]>
[2025-06-09T11:07:42.408+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-09T11:07:42.416+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_ingestion_script> on 2025-06-09 11:07:41.408721+00:00
[2025-06-09T11:07:42.425+0000] {standard_task_runner.py:60} INFO - Started process 795 to run task
[2025-06-09T11:07:42.430+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_dag', 'run_ingestion_script', 'manual__2025-06-09T11:07:41.408721+00:00', '--job-id', '64', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmp5s05mmgf']
[2025-06-09T11:07:42.431+0000] {standard_task_runner.py:88} INFO - Job 64: Subtask run_ingestion_script
[2025-06-09T11:07:42.471+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-09T11:07:41.408721+00:00 [running]> on host 2fcbbaba1dfb
[2025-06-09T11:07:42.515+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_dag' AIRFLOW_CTX_TASK_ID='run_ingestion_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-09T11:07:41.408721+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-09T11:07:41.408721+00:00'
[2025-06-09T11:07:42.516+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-09T11:07:42.518+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ingestion && python ingestion_script.py']
[2025-06-09T11:07:42.526+0000] {subprocess.py:86} INFO - Output:
[2025-06-09T11:07:43.078+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:43,077 - data_ingestion - INFO - AWS_REGION: eu-north-1
[2025-06-09T11:07:43.083+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:43,078 - data_ingestion - INFO - S3_BUCKET: rj-ecom-etl
[2025-06-09T11:07:43.083+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:43,078 - data_ingestion - INFO - AWS_ACCESS_KEY_ID: ***
[2025-06-09T11:07:43.083+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:43,078 - data_ingestion - INFO - AWS_SECRET_ACCESS_KEY: ***
[2025-06-09T11:07:43.084+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:43,078 - data_ingestion - INFO - Using provided AWS credentials
[2025-06-09T11:07:44.366+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:44,361 - data_ingestion - INFO - Successfully connected to AWS S3
[2025-06-09T11:07:44.382+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:44,364 - data_ingestion - INFO - Available buckets: ['rj-ecom-etl']
[2025-06-09T11:07:46.481+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:46,466 - data_ingestion - INFO - Bucket rj-ecom-etl already exists
[2025-06-09T11:07:46.494+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:46,472 - data_ingestion - INFO - Found 9 CSV files to process
[2025-06-09T11:07:46.494+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:46,476 - data_ingestion - INFO - Processing olist_sellers_dataset.csv...
[2025-06-09T11:07:46.514+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:46,514 - data_ingestion - INFO - Read 3095 rows from olist_sellers_dataset.csv
[2025-06-09T11:07:47.055+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:47,054 - data_ingestion - INFO - Validation complete: 3095 valid, 0 invalid
[2025-06-09T11:07:48.715+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:48,712 - data_ingestion - INFO - Uploaded 3095 valid records to s3://rj-ecom-etl/raw/olist_sellers_dataset/2025-06-09/olist_sellers_dataset.parquet
[2025-06-09T11:07:49.333+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:49,332 - data_ingestion - INFO - Processing product_category_name_translation.csv...
[2025-06-09T11:07:49.339+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:49,339 - data_ingestion - INFO - Read 71 rows from product_category_name_translation.csv
[2025-06-09T11:07:49.346+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:49,346 - data_ingestion - INFO - Validation complete: 71 valid, 0 invalid
[2025-06-09T11:07:49.958+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:49,958 - data_ingestion - INFO - Uploaded 71 valid records to s3://rj-ecom-etl/raw/product_category_name_translation/2025-06-09/product_category_name_translation.parquet
[2025-06-09T11:07:50.564+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:50,563 - data_ingestion - INFO - Processing olist_orders_dataset.csv...
[2025-06-09T11:07:51.021+0000] {subprocess.py:93} INFO - 2025-06-09 11:07:51,015 - data_ingestion - INFO - Read 99441 rows from olist_orders_dataset.csv
[2025-06-09T11:08:07.976+0000] {subprocess.py:93} INFO - 2025-06-09 11:08:07,974 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-09T11:09:25.898+0000] {subprocess.py:93} INFO - 2025-06-09 11:09:25,892 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_orders_dataset/2025-06-09/olist_orders_dataset.parquet
[2025-06-09T11:09:26.924+0000] {subprocess.py:93} INFO - 2025-06-09 11:09:26,923 - data_ingestion - INFO - Processing olist_order_items_dataset.csv...
[2025-06-09T11:09:27.649+0000] {subprocess.py:93} INFO - 2025-06-09 11:09:27,648 - data_ingestion - INFO - Read 112650 rows from olist_order_items_dataset.csv
[2025-06-09T11:09:43.633+0000] {subprocess.py:93} INFO - 2025-06-09 11:09:43,630 - data_ingestion - INFO - Validation complete: 112650 valid, 0 invalid
[2025-06-09T11:09:48.436+0000] {subprocess.py:93} INFO - 2025-06-09 11:09:48,424 - data_ingestion - INFO - Uploaded 112650 valid records to s3://rj-ecom-etl/raw/olist_order_items_dataset/2025-06-09/olist_order_items_dataset.parquet
[2025-06-09T11:09:49.610+0000] {subprocess.py:93} INFO - 2025-06-09 11:09:49,599 - data_ingestion - INFO - Processing olist_customers_dataset.csv...
[2025-06-09T11:09:49.897+0000] {subprocess.py:93} INFO - 2025-06-09 11:09:49,895 - data_ingestion - INFO - Read 99441 rows from olist_customers_dataset.csv
[2025-06-09T11:10:05.486+0000] {subprocess.py:93} INFO - 2025-06-09 11:10:05,478 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-09T11:10:10.076+0000] {subprocess.py:93} INFO - 2025-06-09 11:10:10,072 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_customers_dataset/2025-06-09/olist_customers_dataset.parquet
[2025-06-09T11:10:10.790+0000] {subprocess.py:93} INFO - 2025-06-09 11:10:10,789 - data_ingestion - INFO - Processing olist_geolocation_dataset.csv...
[2025-06-09T11:10:13.044+0000] {subprocess.py:93} INFO - 2025-06-09 11:10:13,042 - data_ingestion - INFO - Read 1000163 rows from olist_geolocation_dataset.csv
[2025-06-09T11:12:15.903+0000] {subprocess.py:93} INFO - 2025-06-09 11:12:15,892 - data_ingestion - INFO - Validation complete: 1000163 valid, 0 invalid
[2025-06-09T11:13:25.758+0000] {subprocess.py:93} INFO - 2025-06-09 11:13:25,753 - data_ingestion - INFO - Uploaded 1000163 valid records to s3://rj-ecom-etl/raw/olist_geolocation_dataset/2025-06-09/olist_geolocation_dataset.parquet
[2025-06-09T11:13:30.604+0000] {subprocess.py:93} INFO - 2025-06-09 11:13:30,599 - data_ingestion - INFO - Processing olist_order_payments_dataset.csv...
[2025-06-09T11:13:30.843+0000] {subprocess.py:93} INFO - 2025-06-09 11:13:30,843 - data_ingestion - INFO - Read 103886 rows from olist_order_payments_dataset.csv
[2025-06-09T11:13:43.534+0000] {subprocess.py:93} INFO - 2025-06-09 11:13:43,526 - data_ingestion - INFO - Validation complete: 103886 valid, 0 invalid
[2025-06-09T11:14:01.298+0000] {local_task_job_runner.py:302} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2025-06-09T11:14:01.351+0000] {process_utils.py:131} INFO - Sending 15 to group 795. PIDs of all processes in the group: [796, 795]
[2025-06-09T11:14:01.360+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 795
[2025-06-09T11:14:01.371+0000] {taskinstance.py:2450} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-06-09T11:14:01.398+0000] {subprocess.py:104} INFO - Sending SIGTERM signal to process group
[2025-06-09T11:14:01.977+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=795, status='terminated', exitcode=0, started='11:07:41') (795) terminated with exit code 0
[2025-06-09T11:14:01.985+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=796, status='terminated', started='11:07:41') (796) terminated with exit code None
