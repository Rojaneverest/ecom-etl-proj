[2025-06-07T10:56:49.904+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-07T10:53:53.894472+00:00 [queued]>
[2025-06-07T10:56:49.909+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-07T10:53:53.894472+00:00 [queued]>
[2025-06-07T10:56:49.910+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 3
[2025-06-07T10:56:49.916+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): run_ingestion_script> on 2025-06-07 10:53:53.894472+00:00
[2025-06-07T10:56:49.920+0000] {standard_task_runner.py:60} INFO - Started process 382 to run task
[2025-06-07T10:56:49.927+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_dag', 'run_ingestion_script', 'manual__2025-06-07T10:53:53.894472+00:00', '--job-id', '31', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpqulz60ku']
[2025-06-07T10:56:49.929+0000] {standard_task_runner.py:88} INFO - Job 31: Subtask run_ingestion_script
[2025-06-07T10:56:49.970+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_dag.run_ingestion_script manual__2025-06-07T10:53:53.894472+00:00 [running]> on host ab0825485965
[2025-06-07T10:56:50.021+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_dag' AIRFLOW_CTX_TASK_ID='run_ingestion_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-07T10:53:53.894472+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-07T10:53:53.894472+00:00'
[2025-06-07T10:56:50.022+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-07T10:56:50.024+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/ingestion && python ingestion_script.py']
[2025-06-07T10:56:50.040+0000] {subprocess.py:86} INFO - Output:
[2025-06-07T10:56:50.610+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:50,610 - data_ingestion - INFO - AWS_REGION: eu-north-1
[2025-06-07T10:56:50.615+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:50,610 - data_ingestion - INFO - S3_BUCKET: rj-ecom-etl
[2025-06-07T10:56:50.615+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:50,610 - data_ingestion - INFO - AWS_ACCESS_KEY_ID: ***
[2025-06-07T10:56:50.615+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:50,610 - data_ingestion - INFO - AWS_SECRET_ACCESS_KEY: ***
[2025-06-07T10:56:50.615+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:50,611 - data_ingestion - INFO - Using provided AWS credentials
[2025-06-07T10:56:51.651+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:51,650 - data_ingestion - INFO - Successfully connected to AWS S3
[2025-06-07T10:56:51.655+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:51,651 - data_ingestion - INFO - Available buckets: ['rj-ecom-etl']
[2025-06-07T10:56:53.464+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:53,462 - data_ingestion - INFO - Bucket rj-ecom-etl already exists
[2025-06-07T10:56:53.471+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:53,470 - data_ingestion - INFO - Found 9 CSV files to process
[2025-06-07T10:56:53.473+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:53,471 - data_ingestion - INFO - Processing olist_sellers_dataset.csv...
[2025-06-07T10:56:53.513+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:53,513 - data_ingestion - INFO - Read 3095 rows from olist_sellers_dataset.csv
[2025-06-07T10:56:53.743+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:53,742 - data_ingestion - INFO - Validation complete: 3095 valid, 0 invalid
[2025-06-07T10:56:56.262+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:56,259 - data_ingestion - INFO - Uploaded 3095 valid records to s3://rj-ecom-etl/raw/olist_sellers_dataset/2025-06-07/olist_sellers_dataset.parquet
[2025-06-07T10:56:56.858+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:56,857 - data_ingestion - INFO - Processing product_category_name_translation.csv...
[2025-06-07T10:56:56.868+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:56,867 - data_ingestion - INFO - Read 71 rows from product_category_name_translation.csv
[2025-06-07T10:56:56.874+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:56,871 - data_ingestion - INFO - Validation complete: 71 valid, 0 invalid
[2025-06-07T10:56:57.500+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:57,495 - data_ingestion - INFO - Uploaded 71 valid records to s3://rj-ecom-etl/raw/product_category_name_translation/2025-06-07/product_category_name_translation.parquet
[2025-06-07T10:56:58.090+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:58,088 - data_ingestion - INFO - Processing olist_orders_dataset.csv...
[2025-06-07T10:56:59.459+0000] {subprocess.py:93} INFO - 2025-06-07 10:56:59,455 - data_ingestion - INFO - Read 99441 rows from olist_orders_dataset.csv
[2025-06-07T10:57:17.220+0000] {subprocess.py:93} INFO - 2025-06-07 10:57:17,218 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-07T10:58:34.809+0000] {subprocess.py:93} INFO - 2025-06-07 10:58:34,795 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_orders_dataset/2025-06-07/olist_orders_dataset.parquet
[2025-06-07T10:58:35.890+0000] {subprocess.py:93} INFO - 2025-06-07 10:58:35,890 - data_ingestion - INFO - Processing olist_order_items_dataset.csv...
[2025-06-07T10:58:36.293+0000] {subprocess.py:93} INFO - 2025-06-07 10:58:36,290 - data_ingestion - INFO - Read 112650 rows from olist_order_items_dataset.csv
[2025-06-07T10:58:48.761+0000] {subprocess.py:93} INFO - 2025-06-07 10:58:48,759 - data_ingestion - INFO - Validation complete: 112650 valid, 0 invalid
[2025-06-07T10:59:30.309+0000] {subprocess.py:93} INFO - 2025-06-07 10:59:30,305 - data_ingestion - INFO - Uploaded 112650 valid records to s3://rj-ecom-etl/raw/olist_order_items_dataset/2025-06-07/olist_order_items_dataset.parquet
[2025-06-07T10:59:31.153+0000] {subprocess.py:93} INFO - 2025-06-07 10:59:31,153 - data_ingestion - INFO - Processing olist_customers_dataset.csv...
[2025-06-07T10:59:31.283+0000] {subprocess.py:93} INFO - 2025-06-07 10:59:31,282 - data_ingestion - INFO - Read 99441 rows from olist_customers_dataset.csv
[2025-06-07T10:59:39.490+0000] {subprocess.py:93} INFO - 2025-06-07 10:59:39,483 - data_ingestion - INFO - Validation complete: 99441 valid, 0 invalid
[2025-06-07T10:59:47.037+0000] {subprocess.py:93} INFO - 2025-06-07 10:59:47,033 - data_ingestion - INFO - Uploaded 99441 valid records to s3://rj-ecom-etl/raw/olist_customers_dataset/2025-06-07/olist_customers_dataset.parquet
[2025-06-07T10:59:47.980+0000] {subprocess.py:93} INFO - 2025-06-07 10:59:47,980 - data_ingestion - INFO - Processing olist_geolocation_dataset.csv...
[2025-06-07T10:59:50.140+0000] {subprocess.py:93} INFO - 2025-06-07 10:59:50,139 - data_ingestion - INFO - Read 1000163 rows from olist_geolocation_dataset.csv
[2025-06-07T11:01:17.985+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:17,970 - data_ingestion - INFO - Validation complete: 1000163 valid, 0 invalid
[2025-06-07T11:01:24.619+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:24,617 - data_ingestion - INFO - Uploaded 1000163 valid records to s3://rj-ecom-etl/raw/olist_geolocation_dataset/2025-06-07/olist_geolocation_dataset.parquet
[2025-06-07T11:01:26.293+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:26,284 - data_ingestion - INFO - Processing olist_order_payments_dataset.csv...
[2025-06-07T11:01:26.399+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:26,398 - data_ingestion - INFO - Read 103886 rows from olist_order_payments_dataset.csv
[2025-06-07T11:01:34.986+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:34,978 - data_ingestion - INFO - Validation complete: 103886 valid, 0 invalid
[2025-06-07T11:01:41.848+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:41,844 - data_ingestion - INFO - Uploaded 103886 valid records to s3://rj-ecom-etl/raw/olist_order_payments_dataset/2025-06-07/olist_order_payments_dataset.parquet
[2025-06-07T11:01:42.579+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:42,578 - data_ingestion - INFO - Processing olist_order_reviews_dataset.csv...
[2025-06-07T11:01:42.828+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:42,827 - data_ingestion - INFO - Read 99224 rows from olist_order_reviews_dataset.csv
[2025-06-07T11:01:54.185+0000] {subprocess.py:93} INFO - 2025-06-07 11:01:54,183 - data_ingestion - INFO - Validation complete: 99224 valid, 0 invalid
[2025-06-07T11:02:02.523+0000] {subprocess.py:93} INFO - 2025-06-07 11:02:02,517 - data_ingestion - INFO - Uploaded 99224 valid records to s3://rj-ecom-etl/raw/olist_order_reviews_dataset/2025-06-07/olist_order_reviews_dataset.parquet
[2025-06-07T11:02:03.904+0000] {subprocess.py:93} INFO - 2025-06-07 11:02:03,903 - data_ingestion - INFO - Processing olist_products_dataset.csv...
[2025-06-07T11:02:03.952+0000] {subprocess.py:93} INFO - 2025-06-07 11:02:03,952 - data_ingestion - INFO - Read 32951 rows from olist_products_dataset.csv
[2025-06-07T11:02:07.637+0000] {subprocess.py:93} INFO - 2025-06-07 11:02:07,635 - data_ingestion - INFO - Validation complete: 32951 valid, 0 invalid
[2025-06-07T11:02:08.488+0000] {subprocess.py:93} INFO - 2025-06-07 11:02:08,487 - data_ingestion - INFO - Uploaded 32951 valid records to s3://rj-ecom-etl/raw/olist_products_dataset/2025-06-07/olist_products_dataset.parquet
[2025-06-07T11:02:09.388+0000] {subprocess.py:93} INFO - 2025-06-07 11:02:09,387 - data_ingestion - INFO - Data ingestion completed. Processed 9 out of 9 files successfully.
[2025-06-07T11:02:09.445+0000] {subprocess.py:93} INFO -          523648349 function calls (513356181 primitive calls) in 318.781 seconds
[2025-06-07T11:02:09.446+0000] {subprocess.py:93} INFO - 
[2025-06-07T11:02:09.446+0000] {subprocess.py:93} INFO -    Ordered by: cumulative time
[2025-06-07T11:02:09.446+0000] {subprocess.py:93} INFO -    List reduced from 2457 to 20 due to restriction <20>
[2025-06-07T11:02:09.446+0000] {subprocess.py:93} INFO - 
[2025-06-07T11:02:09.447+0000] {subprocess.py:93} INFO -    ncalls  tottime  percall  cumtime  percall filename:lineno(function)
[2025-06-07T11:02:09.447+0000] {subprocess.py:93} INFO -         1    2.022    2.022  318.781  318.781 ingestion_script.py:598(main)
[2025-06-07T11:02:09.447+0000] {subprocess.py:93} INFO -         9    6.870    0.763  313.897   34.877 ingestion_script.py:425(process_csv_file)
[2025-06-07T11:02:09.447+0000] {subprocess.py:93} INFO -        20    0.001    0.000  155.762    7.788 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:544(_api_call)
[2025-06-07T11:02:09.453+0000] {subprocess.py:93} INFO -        20    0.008    0.000  155.760    7.788 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:925(_make_api_call)
[2025-06-07T11:02:09.454+0000] {subprocess.py:93} INFO -        20    0.000    0.000  155.521    7.776 /home/***/.local/lib/python3.8/site-packages/botocore/client.py:1013(_make_request)
[2025-06-07T11:02:09.455+0000] {subprocess.py:93} INFO -        20    0.000    0.000  155.520    7.776 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:113(make_request)
[2025-06-07T11:02:09.455+0000] {subprocess.py:93} INFO -        20    0.001    0.000  155.520    7.776 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:194(_send_request)
[2025-06-07T11:02:09.456+0000] {subprocess.py:93} INFO -        21    0.002    0.000  155.471    7.403 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:235(_get_response)
[2025-06-07T11:02:09.456+0000] {subprocess.py:93} INFO -        21    0.007    0.000  155.466    7.403 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:263(_do_get_response)
[2025-06-07T11:02:09.457+0000] {subprocess.py:93} INFO -        21    0.001    0.000  155.427    7.401 /home/***/.local/lib/python3.8/site-packages/botocore/endpoint.py:376(_send)
[2025-06-07T11:02:09.458+0000] {subprocess.py:93} INFO -        21    0.008    0.000  155.426    7.401 /home/***/.local/lib/python3.8/site-packages/botocore/httpsession.py:447(send)
[2025-06-07T11:02:09.458+0000] {subprocess.py:93} INFO -        21    0.006    0.000  155.385    7.399 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:534(urlopen)
[2025-06-07T11:02:09.458+0000] {subprocess.py:93} INFO -        21    0.011    0.001  155.339    7.397 /home/***/.local/lib/python3.8/site-packages/urllib3/connectionpool.py:379(_make_request)
[2025-06-07T11:02:09.459+0000] {subprocess.py:93} INFO -        21    0.006    0.000   76.410    3.639 /usr/local/lib/python3.8/http/client.py:1304(getresponse)
[2025-06-07T11:02:09.460+0000] {subprocess.py:93} INFO -        21    0.004    0.000   76.391    3.638 /usr/local/lib/python3.8/http/client.py:309(begin)
[2025-06-07T11:02:09.460+0000] {subprocess.py:93} INFO -       473    0.002    0.000   76.348    0.161 /usr/local/lib/python3.8/socket.py:655(readinto)
[2025-06-07T11:02:09.462+0000] {subprocess.py:93} INFO -        21    0.006    0.000   76.348    3.636 /usr/local/lib/python3.8/http/client.py:276(_read_status)
[2025-06-07T11:02:09.463+0000] {subprocess.py:93} INFO -       473    0.002    0.000   76.345    0.161 /usr/local/lib/python3.8/ssl.py:1263(recv_into)
[2025-06-07T11:02:09.464+0000] {subprocess.py:93} INFO -       246    0.002    0.000   76.343    0.310 {method 'readline' of '_io.BufferedReader' objects}
[2025-06-07T11:02:09.464+0000] {subprocess.py:93} INFO -       473    0.002    0.000   76.343    0.161 /usr/local/lib/python3.8/ssl.py:1123(read)
[2025-06-07T11:02:09.465+0000] {subprocess.py:93} INFO - 
[2025-06-07T11:02:09.466+0000] {subprocess.py:93} INFO - 
[2025-06-07T11:02:09.830+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-07T11:02:09.962+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=ingestion_dag, task_id=run_ingestion_script, execution_date=20250607T105353, start_date=20250607T105649, end_date=20250607T110209
[2025-06-07T11:02:10.083+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-07T11:02:10.146+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
